package com.changjinxiong.deepneuralnets.test;

import static org.junit.Assert.*;

import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.image.BufferedImage;
import java.awt.image.WritableRaster;
import java.io.File;
import java.io.IOException;
import java.nio.file.Paths;
import java.util.Arrays;
import java.util.logging.Level;
import java.util.logging.Logger;

import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;

import org.junit.Test;

import com.changjinxiong.deepneuralnets.nn.ConvolutionalLayer;
import com.changjinxiong.deepneuralnets.nn.ConvolutionalNeuralNetwork;
import com.changjinxiong.deepneuralnets.nn.FullyConnectedLayer;
import com.changjinxiong.deepneuralnets.nn.Layer;
import com.changjinxiong.deepneuralnets.nn.MultiLayerPerceptron;
import com.changjinxiong.deepneuralnets.nn.NeuralNetwork;
import com.changjinxiong.deepneuralnets.nn.PoolingLayer;
import com.changjinxiong.deepneuralnets.nn.PoolingLayer.PoolingType;
import com.changjinxiong.deepneuralnets.nn.Util.ActivationType;
import com.changjinxiong.deepneuralnets.test.CIFAR10DataProvider.DatasetType;

public class TestCIFAR {
	int interval = 1500;

	@Test
	public void testCIFAR10DataProvider() {
		JFrame frame = new JFrame();
		frame.setMinimumSize(new Dimension(384, 384));
		frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		frame.getContentPane().setLayout(null);
        JLabel imageLabel = new JLabel();
        JLabel type = new JLabel("!!!!");
		frame.getContentPane().add(imageLabel);
		frame.getContentPane().add(type);
		imageLabel.setBounds(128, 80, 128, 128);
		type.setBounds(128, 208, 120, 16);
		imageLabel.setVisible(true);
		type.setVisible(true);
		frame.getContentPane().setVisible(true);
		frame.setVisible(true);
		String p = Paths.get(System.getProperty("user.dir"), "..", "..", "..","datasets", "CIFAR", "cifar-10-batches-bin").toString();
		CIFAR10DataProvider cp = new CIFAR10DataProvider(p, 1, DatasetType.TRAINING_ALL, false, true, false);
		int width = 32;
		int height = 32;
		String[] labels= {"airplane", 
				"automobile",
				"bird",
				"cat",
				"deer",
				"dog",
				"frog",
				"horse",
				"ship", 
				"truck"};
		
		for (int i = 0; i < cp.getDatasetSize(); i ++) {
			float[] floatPixels = cp.getNextbatchInput();
//			double[] floatPixels = {23.2893, -4.14037, -26.0504, -29.5689, -7.18469, 22.1482, 38.6285, 46.1091, 7.51495, -23.9326, -29.234, -26.4037, -12.6202, -8.63419, 45.366, 81.3886, 73.4695, 30.4964, 28.509, 22.6165, -19.1096, -32.9583, -39.8102, -44.5266, -62.0462, -73.6069, -77.0759, -55.3248, -37.5888, -40.059, -43.3931, -51.174, 9.9007, 15.6554, -5.2169, -6.5724, 18.8458, 20.1777, 41.6399, 45.1596, 0.607666, -23.8755, -1.26447, 28.5847, 57.3613, 83.337, 105.359, 110.543, 106.593, 103.513, 99.5326, 91.6034, 7.84546, -38.0784, -34.8882, -38.5548, -43.9674, -52.5395, -66.9404, -47.1943, -38.5414, -34.0425, -52.3304, -58.1568, 10.2753, 10.2834, -14.4735, 17.1472, 7.63844, 1.03944, 38.5186, 45.9982, 38.3483, 58.8674, 85.4502, 100.225, 95.1457, 105.121, 110.209, 112.38, 98.3334, 91.2532, 101.318, 109.501, 43.743, -32.155, -32.0029, -44.622, -29.0397, -37.5621, -66.0204, -47.4232, -39.8321, -50.2107, -60.5909, -61.5913, 6.53806, 8.62764, -7.05286, 2.49387, 21.1274, 50.6845, 72.1843, 76.551, 75.8367, 70.3338, 45.9904, 35.7907, 30.8539, -8.22543, 44.7717, 106.968, 97.9492, 77.8941, 62.0123, 68.1746, 50.4693, -11.318, -41.2359, -37.8846, -40.3713, -53.9019, -61.3678, -32.9241, -41.4523, -52.8304, -64.2162, -57.3197, -0.201447, 12.9407, 7.37192, 56.9476, 85.7247, 72.2746, 33.7692, 19.2145, 6.58305, -12.8225, -38.2745, -24.5331, -24.4242, -100.452, -2.48814, 108.713, 103.759, 102.683, 78.6847, 62.9119, 1.33282, -6.3998, -29.2534, -32.9785, -42.6182, -50.2548, -39.7783, -35.3399, -59.9286, -57.4043, -59.9097, -41.0466, 7.09386, 8.2703, -1.11824, 24.5613, 9.38351, -9.03523, -36.4755, -31.8776, -27.4613, -34.9293, -45.4128, -12.7071, -34.5502, -85.5831, -14.6233, 71.5584, 96.6321, 101.484, 104.404, 105.613, 33.9262, -4.79063, -6.5732, -38.2177, -41.9505, -51.7501, -42.2972, -30.8076, -52.4239, -60.956, -46.5288, -36.7188, 17.5136, -3.2023, -39.5193, -42.7071, -40.9532, -44.2715, -53.6865, -51.0467, -60.6004, -77.1503, -90.6005, -76.8027, -65.6437, -45.6547, -13.7336, 13.3692, 44.4811, 82.3507, 101.268, 108.424, 49.607, -2.10139, -14.777, -46.4748, -55.226, -58.0692, -42.7139, -42.2247, -37.8525, -44.4178, -50.0325, -46.3172, 34.0049, -16.598, -63.8659, -53.9925, -69.1542, -81.5778, -80.9655, -97.1595, -113.646, -110.265, -90.6833, -66.7618, -37.62, -8.73827, -41.8481, -9.75677, 9.2011, 24.0122, 68.9829, 105.204, 79.443, 62.6017, 16.901, -20.898, -27.5315, -29.2989, -31.085, -54.6612, -48.2893, -32.8291, -43.5338, -52.8835, -0.45488, -55.961, -89.2252, -92.291, -79.4581, -41.8843, 1.75612, -23.3087, -54.7113, -34.3276, -3.70442, 9.12663, -13.9324, -9.10684, -71.2529, -62.3737, -21.5096, 47.398, 58.4012, 103.576, 78.9833, 20.2163, 54.3565, 40.5097, -15.1793, -38.8936, -43.5872, -62.2384, -70.7697, -38.275, -44.9728, -63.4166, -56.2284, -51.6875, -53.813, -44.8534, -4.068, 34.588, 31.1988, 1.14116, -34.2196, -29.7562, -0.144302, 4.53925, -24.7482, -9.94579, -75.08, -92.1952, -54.3607, 62.6402, 96.5426, 102.634, 70.0932, -19.5037, 19.8226, 63.9858, 30.1778, -23.6372, -58.2777, -51.9227, -46.385, -37.8647, -58.562, -70.1218, -77.9714, -27.4094, -20.4941, -2.56512, 22.2268, 16.7896, -12.5671, -18.7919, -32.0636, -26.3533, -2.93954, -0.330353, -27.5171, -10.8196, -63.0398, -94.209, -52.2378, 60.7086, 96.588, 102.727, 82.1194, 12.5962, 28.0659, 66.2889, 75.557, 46.7791, -30.9408, -54.4681, -23.9212, -26.4126, -32.1433, -46.7896, -67.6777, -21.9761, -36.0584, -13.1556, 12.5082, 3.88516, -3.47736, -5.63314, -18.7897, -20.0988, -10.7788, -3.24838, -25.5933, -12.9819, -51.2137, -88.4717, -49.4726, 59.5364, 94.5084, 103.816, 84.2742, 17.7368, 37.0597, 62.4178, 56.7661, 66.1065, 48.4282, -3.04238, -14.4111, -21.9498, -32.7742, -30.4704, -42.3556, -20.603, -43.593, -35.6506, -7.0683, -12.8527, -12.3618, -21.5733, -26.7097, -23.1875, -14.9491, 6.40486, -3.98578, -5.32596, -57.5716, -87.7903, -40.8821, 61.1776, 92.2495, 100.574, 86.2049, 16.6381, 24.9379, 63.3216, 63.6986, 52.2074, 57.6678, 59.2429, 20.9826, -22.5346, -44.515, -39.2156, -42.8943, -25.0772, -53.13, -36.3555, -19.8612, -26.685, -37.2055, -32.5282, -19.8992, 0.423439, 13.62, 33.8754, 30.5226, 21.3044, -23.9485, -65.0785, -41.114, 57.8641, 89.9545, 97.281, 86.7164, 32.214, 30.7613, 60.1837, 75.7801, 70.4003, 54.91, 54.7198, 69.4827, 37.9474, -38.1222, -59.9167, -42.632, -20.6055, -37.7187, -7.13396, 32.1955, 43.5125, 46.0213, 34.502, 25.8197, 34.202, 72.5698, 100.96, 102.449, 90.1885, 50.063, 15.0636, 29.037, 75.9618, 93.953, 95.1391, 85.5341, 40.2344, 36.9879, 62.6533, 81.2726, 68.9231, 74.5891, 63.3983, 59.0537, 65.4107, 42.3406, -38.6508, 20.3658, 56.4944, 30.5242, 57.2404, 94.6637, 118.052, 120.393, 106.649, 99.1816, 99.6692, 111.165, 122.608, 125.006, 107.788, 41.6637, 65.8267, 97.7816, 92.6556, 93.5741, 90.6938, 85.2261, 43.9865, 36.5996, 61.337, 84.0222, 70.665, 75.3456, 57.1258, 61.6186, 62.9498, 63.8894, 21.6769, 71.482, 116.72, 107.952, 118.873, 116.506, 117.925, 123.177, 125.476, 124.189, 125.6, 123.001, 119.507, 122.931, 101.671, 77.7353, 87.012, 90.0569, 89.038, 89.0459, 88.2116, 84.6154, 42.2615, 35.8053, 56.4373, 82.196, 73.7721, 78.4748, 45.1642, 14.4715, 73.6121, 63.3061, 31.87, 80.6899, 129.165, 128.674, 128.879, 126.594, 127.092, 128.284, 125.603, 123.302, 122.822, 123.317, 116.901, 122.407, 102.035, 91.2756, 87.5401, 88.7853, 88.9726, 88.0269, 90.1289, 86.3828, 40.7918, 36.2655, 57.7957, 84.5304, 82.1504, 87.7559, 57.294, 14.4505, 53.3656, 80.8282, 42.24, 93.8126, 128.595, 119.486, 118.912, 111.787, 100.346, 93.6039, 85.9222, 81.4931, 76.138, 70.8168, 60.413, 50.1554, 45.8242, 59.0419, 72.2833, 88.5351, 96.7658, 93.8556, 93.9423, 90.1921, 55.4122, 36.8639, 51.2731, 83.9305, 84.5716, 87.1187, 72.4637, 46.4198, 45.0563, 80.2385, 57.4062, 13.9519, 13.9562, -1.8579, -13.2626, -11.076, -18.2889, -41.9277, -45.5012, -28.0717, -11.324, -4.59892, -16.0113, -54.1912, -68.2701, -39.11, -35.9377, -21.7597, 11.3586, 39.4077, 72.566, 90.8167, 69.9829, 55.3438, 55.7646, 80.3184, 83.8639, 89.3632, 96.4642, 81.1602, 75.603, 83.5129, 75.4623, -55.0644, -35.7565, -35.3838, -83.5798, -52.206, -32.0989, -67.5747, -72.1289, -34.673, -15.8735, -32.9726, 33.7425, 33.4947, 23.4013, 25.5958, -7.18242, -45.176, -65.2515, -49.0597, 34.0185, 93.1052, 77.3377, 84.7244, 79.0571, 82.4126, 82.6874, 85.1854, 92.216, 88.876, 90.1093, 86.6442, 80.4437, 29.8464, 40.4457, 31.9507, -71.1277, -26.5788, -24.2989, -57.551, -64.0136, 4.58894, 21.4147, 11.1886, 111.134, 121.049, 109.876, 108.092, 104.326, 96.1938, 74.1061, 43.3028, 53.2671, 70.1889, 38.5043, 40.8028, 7.06312, 61.3246, 92.4977, 87.899, 95.0121, 92.5142, 92.3693, 88.5878, 86.166, 36.8832, 2.5672, -9.83104, -71.7984, -31.1318, -42.689, -55.6703, -54.8855, 0.842377, 7.56488, -15.681, 39.309, 22.3112, 7.25212, 20.379, 35.5141, 46.4384, 18.3635, 40.3448, 62.2159, 10.1476, -7.60918, -10.3895, -46.0415, -19.8283, 17.3117, 32.5132, 47.5822, 55.8138, 69.3988, 72.5696, 80.0739, 23.7608, -63.7229, -91.0936, -87.818, -77.0146, -76.4479, -80.2338, -80.2887, -67.4767, -61.7647, -13.9419, 34.0802, 9.06342, -25.8469, -44.7451, -50.7507, -76.8481, -109.943, -58.0001, 52.0195, -42.9007, -46.8224, -60.6794, -69.4556, -79.2711, -80.1729, -69.0457, -64.1761, -62.0876, -50.5946, -24.5204, 52.0222, 48.505, -27.1103, -63.3272, -57.9789, -53.9999, -51.4, -52.1027, -46.0839, -46.2219, -20.5188, 50.3376, 63.4678, 49.5682, -32.3114, -82.1802, -58.2104, -84.2619, -106.271, -101.302, 10.6691, -32.1723, -58.2181, -43.2828, -38.3285, -28.2016, -46.1291, -65.029, -85.4411, -94.3907, -100.924, -77.7955, 30.8684, 30.2963, 28.5643, 32.2504, 40.6937, 45.8503, 48.4917, 46.7741, 49.8242, 44.6702, 35.4648, 31.42, 32.5523, 14.739, -66.0647, -107.776, -69.8666, -83.9141, -104.846, -106.897, -58.218, -27.1514, -29.2575, -21.4934, -11.5739, -18.5206, -62.5082, -53.5073, -69.0324, -94.071, -81.5682, -88.2479, -35.3164, 41.1758, 25.1507, -19.3753, 3.98542, 28.1875, 23.8718, 7.16358, 7.27788, 11.1579, 38.0465, 64.107, 37.4098, 3.67744, -44.0781, -55.9207, -53.0359, -80.1418, -80.196, -104.184, -78.4373, -33.5553, -32.7604, -34.0391, -22.2004, -27.1332, -56.1912, -47.32, -75.8877, -95.0064, -59.3672, -66.8427, -36.6316, 48.0559, 17.7104, -77.9855, -77.8055, -62.8433, -67.2708, -74.98, -70.8955, -39.8771, 54.1727, 98.2965, 47.7452, -20.756, -38.5276, -21.562, -42.556, -35.7194, 7.1591, -80.8582, -75.0374, -39.2857, -45.6644, -47.1175, -35.243, -32.2087, -25.3334, -47.6423, -77.1276, -87.1321, -19.1768, -28.4244, -0.908257, 37.7517, 17.1471, -7.88676, -8.93528, -5.22446, -6.88074, -7.65452, -4.54612, 3.62174, 28.7058, 39.9128, 22.3847, -21.1641, -78.9588, -97.9045, -63.8754, -11.0778, -0.192337, -73.318, -74.6594, -50.9855, -49.3429, -51.5811, -45.7986, -41.9416, -2.99408, -35.2579, -36.649, -91.3334, -46.1184, -56.0198, -31.2559, 48.4463, 31.4116, 30.0749, 23.7403, 32.1172, 38.3217, 37.5231, 44.544, 42.5932, 29.621, 40.8844, 42.2986, 11.5632, -60.3421, -81.2693, -61.2547, -40.2429, -21.3108, -56.4786, -62.7763, -60.122, -71.377, -78.5013, -83.7266, -79.9315, -20.9448, -68.058, -91.3184, -100.709, -82.2404, -63.689, -32.5167, 37.9319, 30.531, 33.7151, 6.04116, -30.8299, -22.8164, -16.7137, 3.1722, 29.0758, 31.0871, 57.259, 54.505, 0.63208, -41.4041, -36.4435, -61.4286, -81.266, -49.3215, -66.382, -79.6423, -89.922, -104.074, -111.214, -114.331, -111.44, -66.3506, -76.2136, -71.2609, -44.3959, -22.4925, -2.58606, 5.0033, 35.2653, 31.402, 36.1348, 18.1202, -84.0942, -108.326, -107.433, -53.5439, 6.32326, -8.74576, -17.7572, -28.72, -66.695, -100.779, -109.919, -110.902, -102.728, -98.7778, -111.833, -122.95, -122.119, -118.182, -103.14, -77.0022, -59.9012, -37.7712, -11.5215, 6.71678, 12.9366, 16.2216, 16.435, 16.3609, 40.9439, 1.55762, -32.2462, -35.678, -6.22858, 28.1455, 51.7161, 60.2593, 16.7248, -19.6326, -32.941, -36.0906, -19.2688, -11.2617, 47.7746, 85.8279, 70.9067, 26.9386, 24.9465, 20.0391, -22.7138, -38.6188, -44.4984, -50.2973, -68.9465, -78.5873, -81.1072, -59.4154, -40.7739, -41.307, -45.7085, -54.4736, 24.7052, 18.5409, -10.1767, -6.43063, 25.082, 27.5135, 51.1109, 51.7179, 1.26074, -27.1193, -11.4895, 17.3934, 53.1872, 80.1822, 102.248, 107.454, 103.495, 100.459, 96.4878, 88.5147, 4.71286, -41.2882, -37.1658, -41.9297, -48.4783, -56.1335, -69.6023, -49.9791, -40.4965, -36.1386, -54.559, -61.3837, 20.3518, 12.5025, -19.0555, 18.7224, 15.4015, 9.9901, 48.6047, 53.216, 39.6949, 58.3238, 80.9618, 95.7856, 99.7079, 107.686, 106.826, 105.054, 94.0304, 89.0027, 98.0764, 106.179, 40.3524, -34.6446, -33.5919, -47.3223, -32.906, -40.5319, -68.0987, -48.6961, -41.3413, -51.9582, -63.5415, -64.5577, 12.9136, 9.18404, -12.2199, -0.437881, 23.4532, 59.2875, 88.0216, 92.5698, 87.9777, 83.5917, 58.3357, 48.1882, 50.2636, 5.2066, 46.2502, 100.534, 94.5658, 76.5556, 59.6611, 64.7324, 47.9448, -11.9589, -40.9943, -37.7853, -40.4709, -54.1811, -61.8307, -33.6277, -42.438, -55.1329, -66.7837, -59.9538, 3.47774, 13.8549, 6.61438, 53.525, 87.6409, 83.5286, 55.3526, 45.0489, 28.6142, 12.3407, -12.025, 2.77852, 4.92294, -82.0757, 3.9212, 105.209, 101.301, 102.241, 77.2109, 60.3614, 0.69252, -5.14577, -26.1573, -29.0879, -40.9417, -50.8279, -39.6292, -35.4901, -59.3921, -59.2305, -62.0755, -43.3611, 11.0804, 17.5493, 16.572, 40.6524, 28.8789, 9.85233, -16.2013, -13.2427, -11.5412, -15.8074, -24.1769, 10.6011, -13.1617, -73.1448, -10.1563, 74.0872, 99.1627, 103.991, 107.892, 108.061, 38.2575, -6.60976, 0.36824, -29.5338, -44.5113, -55.6295, -45.5353, -32.4341, -54.4101, -62.3547, -48.3205, -38.7099, 21.8138, 7.40749, -21.4095, -25.1221, -19.9144, -26.7801, -39.6977, -37.6232, -44.8142, -58.0143, -69.2255, -50.3389, -41.1327, -36.0612, -12.1019, 15.0237, 48.0784, 86.9066, 105.803, 113.896, 53.932, -8.94553, -11.8998, -37.9307, -59.0035, -62.2618, -45.3403, -45.2899, -40.3729, -45.4293, -51.4579, -47.9687, 40.5986, -4.64, -52.3495, -46.9517, -57.6231, -71.5048, -73.3094, -86.0109, -95.0301, -88.1982, -65.2906, -35.2321, -3.01328, 4.98584, -42.0517, -8.94564, 13.934, 29.7157, 74.633, 111.74, 80.7953, 48.7768, 8.75938, -18.4345, -31.5, -31.7516, -33.0508, -57.127, -50.2675, -33.379, -44.5361, -54.1658, 6.46565, -38.6187, -76.2916, -88.8015, -73.4489, -36.256, 5.02478, -15.4739, -36.3081, -12.4432, 22.572, 41.6081, 24.7201, 4.74884, -71.2797, -56.378, -14.5883, 53.2431, 64.1331, 110.152, 76.3391, -5.651, 33.1265, 36.8634, -17.3256, -40.6053, -45.8901, -65.1187, -73.1748, -37.3042, -44.5565, -63.3342, -54.9271, -29.9451, -34.4739, -39.9002, 2.4502, 40.7691, 33.0871, 8.72148, -13.9836, -5.9722, 27.0809, 39.0553, 13.0408, 0.112602, -72.8433, -76.9111, -43.1771, 68.6951, 103.463, 111.384, 61.5305, -59.4143, -13.5018, 57.1953, 29.7697, -22.6687, -58.9415, -54.2078, -48.2324, -36.4169, -57.769, -69.6809, -83.3278, -5.28758, 2.25976, 5.86804, 32.292, 25.5573, -10.0512, -11.4995, -12.0033, -0.633598, 27.3217, 36.3243, 7.4656, -1.53136, -56.5515, -68.6237, -35.7437, 69.084, 104.794, 110.679, 70.689, -32.2892, -9.30238, 58.3677, 74.9536, 46.4707, -30.9002, -56.0949, -25.2346, -24.4978, -30.9156, -46.0091, -70.6878, -5.47232, -12.8519, 5.79698, 29.1577, 18.3207, 7.75206, 6.38672, -0.907356, 4.56182, 23.5379, 37.5491, 9.5675, 1.54742, -36.4508, -56.5736, -25.6461, 76.2203, 106.957, 108.919, 74.9269, -20.08, 3.7292, 52.4085, 49.0272, 58.6323, 44.2431, -3.0065, -12.1864, -19.5383, -33.0349, -32.2903, -39.9641, -2.66582, -19.8837, -7.13514, 23.225, 15.2829, 13.6139, 2.2634, -0.981377, 9.4005, 27.4073, 52.2781, 29.3256, 11.413, -40.5623, -57.6325, -15.7748, 80.1795, 107.002, 106.923, 81.0632, -15.9764, -6.25494, 51.3222, 51.8955, 38.6031, 48.2479, 54.9552, 19.7665, -22.6091, -46.299, -42.6146, -38.1544, -6.75826, -31.9643, -9.28204, 10.0742, 2.12186, -11.4846, -9.86888, 1.6981, 26.9555, 45.9933, 68.8425, 56.9829, 37.2379, -8.73416, -42.7392, -19.7726, 77.1691, 106.024, 107.947, 86.8632, 2.7467, -0.381737, 47.1737, 61.8912, 53.643, 40.2477, 44.0981, 61.866, 33.3943, -43.4689, -64.9391, -41.6083, -7.95044, -23.1192, 6.47002, 44.7366, 52.9834, 54.4517, 40.9082, 31.2219, 42.5865, 83.8351, 114.88, 119.9, 104.102, 63.2216, 30.3729, 48.4349, 95.3799, 111.095, 109.855, 90.6945, 14.6931, 6.67044, 47.4279, 65.1853, 54.9026, 61.5968, 51.3829, 47.0189, 55.3703, 34.4253, -42.3133, 15.7206, 60.55, 34.5606, 61.2998, 98.7226, 120.129, 119.427, 106.642, 102.173, 104.677, 116.113, 128.263, 134.182, 119.411, 53.5582, 75.8602, 113.892, 111.785, 112.433, 109.08, 95.0211, 21.1206, 7.93428, 43.7668, 70.5547, 64.2282, 67.8772, 47.5963, 50.0507, 50.3325, 55.3324, 19.3252, 62.1239, 114.115, 106.364, 122.317, 122.951, 124.421, 127.659, 131.903, 134.613, 135.023, 133.368, 128.6, 130.554, 113.707, 91.0954, 97.5138, 104.562, 106.537, 107.288, 108.009, 95.8053, 23.7844, 7.56384, 36.3169, 70.1012, 69.6883, 69.3365, 29.9591, -3.76932, 55.3075, 51.0671, 27.7962, 73.5544, 122.792, 126.301, 131.518, 131.254, 132.784, 134.008, 133.262, 130.886, 130.346, 132.723, 130.008, 133.047, 116.104, 108.618, 106.029, 104.304, 104.443, 104.243, 105.907, 94.5548, 29.2818, 9.03152, 33.7528, 69.5371, 67.1893, 63.799, 23.3023, -25.6002, 22.2563, 59.7927, 30.3507, 88.8728, 126.392, 121.282, 121.677, 115.533, 104.127, 99.3849, 92.5647, 88.9993, 84.5211, 79.9532, 70.1855, 59.4245, 57.5415, 76.0315, 91.365, 104.666, 110.846, 108.68, 109.344, 96.034, 43.6102, 8.35246, 26.0229, 68.8253, 68.5872, 62.2114, 37.591, 5.52968, 13.0915, 58.3207, 43.6652, 11.1834, 19.9211, 5.05924, -8.40642, -8.2894, -14.5277, -37.2443, -39.0167, -17.774, 2.74256, 6.08264, -11.7665, -48.4643, -60.1498, -26.7249, -21.5025, -8.3131, 24.7757, 53.5639, 87.326, 94.0733, 52.6531, 24.3764, 30.1366, 66.952, 70.6473, 70.2571, 70.5152, 51.297, 48.6876, 64.6797, 61.8842, -53.6786, -21.678, -22.4229, -78.7157, -49.4812, -29.5218, -64.1585, -66.0033, -19.8283, 5.631, -20.927, 33.3173, 35.4944, 28.7351, 34.1344, 4.39202, -32.5814, -51.6812, -36.7063, 46.9661, 89.596, 52.3428, 50.2113, 52.9947, 69.6933, 70.1913, 69.8505, 74.1064, 67.9, 68.1348, 68.8507, 65.986, 35.3687, 61.5854, 50.8972, -65.3746, -25.0353, -21.9906, -55.5168, -57.3591, 24.8773, 50.2778, 26.5224, 106.965, 120.256, 113.387, 114.756, 113.998, 109.88, 87.7712, 54.8085, 64.4204, 61.9349, 9.83362, 1.68306, -22.5637, 47.1404, 78.6372, 75.2967, 82.6709, 78.3511, 74.314, 72.7864, 70.7625, 41.4399, 21.7033, 9.05124, -66.1948, -30.8368, -41.7297, -54.0864, -49.7475, 15.5522, 29.784, -3.09806, 36.343, 23.6937, 11.8788, 26.1427, 43.338, 57.2648, 29.1664, 49.027, 68.5984, -6.83888, -43.9935, -50.1751, -74.2845, -33.5481, 7.01356, 20.5678, 36.9709, 45.453, 54.2756, 59.7612, 66.7193, 22.3498, -57.5813, -79.2684, -82.3726, -76.9739, -74.8655, -78.0921, -76.6404, -60.3434, -55.1836, -6.02436, 42.3732, 16.6411, -18.1214, -36.8916, -44.7709, -68.8491, -100.975, -52.1445, 54.5596, -62.7411, -77.9704, -85.1191, -85.3053, -85.5542, -84.936, -81.362, -76.0669, -70.6209, -61.8419, -33.3851, 46.6499, 45.1276, -26.0095, -55.6438, -51.7716, -49.2564, -45.1677, -46.3671, -37.8883, -32.6226, -6.5164, 64.6564, 75.0841, 50.3874, -27.377, -73.1097, -46.018, -70.0668, -92.0931, -90.255, 16.4372, -30.7537, -57.0411, -41.3433, -35.7385, -23.9906, -48.3277, -75.6849, -96.601, -101.132, -105.31, -80.7288, 30.4654, 23.9062, 28.5919, 38.7669, 47.6744, 52.2796, 55.3874, 55.1086, 55.5539, 49.7829, 43.9601, 36.1803, 28.5431, 8.91656, -63.7408, -95.3092, -51.3172, -63.4008, -86.3593, -90.538, -47.0773, -12.2868, -13.5957, -12.0809, -7.52186, -15.7983, -63.1383, -63.4949, -78.5068, -97.0612, -79.0771, -86.2474, -32.7345, 33.7671, 23.1144, -15.9848, 7.76474, 31.3427, 27.4468, 11.1242, 3.56888, 1.78802, 35.0022, 52.2789, 14.7608, -3.78002, -41.3854, -45.1105, -37.1508, -61.2789, -62.3907, -88.5223, -66.9645, -22.2997, -23.6928, -31.1954, -27.6457, -29.8597, -55.2358, -54.6584, -84.6694, -96.2186, -53.0046, -61.9071, -34.0504, 38.6568, 14.619, -74.7164, -78.2062, -66.9192, -70.9812, -79.3468, -79.0291, -46.7413, 56.5728, 86.8947, 22.5091, -21.8219, -33.4546, -14.3868, -35.3267, -23.5025, 21.3056, -70.8408, -68.1742, -34.5951, -41.1257, -45.7788, -38.1253, -31.3488, -23.7545, -53.3011, -84.1301, -86.4792, -12.9146, -24.5203, -1.3178, 29.3487, 16.0324, -2.69494, -7.48822, -11.4777, -13.8073, -10.2985, -5.98846, 5.36852, 38.6518, 39.0492, 11.6808, -15.6958, -71.3845, -92.2402, -59.2197, -1.45392, 10.3941, -66.8128, -72.2761, -45.7584, -43.2882, -46.7248, -42.129, -36.4557, 2.26342, -38.2171, -41.8484, -93.7834, -44.9034, -57.1382, -36.659, 41.0467, 30.2665, 37.1989, 31.0552, 31.7124, 33.2096, 42.646, 52.8339, 45.0443, 32.2437, 42.675, 44.2461, 19.6885, -51.1333, -73.0236, -52.0377, -29.0787, -9.18726, -49.4132, -58.7842, -55.2863, -66.7477, -77.0397, -84.4213, -76.7451, -12.9138, -65.2053, -95.6635, -108.224, -89.0034, -70.7463, -41.8601, 27.6238, 27.4168, 36.8131, 6.28526, -35.3643, -31.096, -15.8045, 6.22104, 26.2883, 28.4448, 54.7693, 53.1491, 7.39914, -32.5416, -28.5746, -52.5908, -70.4618, -38.5692, -59.6761, -75.0039, -85.4018, -100.706, -111.009, -117.261, -110.479, -59.5411, -74.5924, -75.7989, -52.0521, -31.3376, -10.6484, -4.2858, 21.0522, 22.3467, 30.2432, 9.3779, -93.661, -116.714, -111.665, -57.6494, -0.655418, -15.5873, -24.4671, -32.3349, -62.2397, -94.2392, -104.365, -105.358, -91.1983, -88.2712, -105.365, -119.552, -119.82, -116.994, -104.09, -81.0803, -62.0799, -36.1054, -13.041, 1.04266, 4.148, 7.30292, 8.38258, 7.1497, 54.4462, 4.14642, -37.5814, -33.8775, 5.73262, 46.2197, 75.845, 79.4773, 20.9858, -25.2914, -37.51, -33.659, -18.8157, -8.80779, 53.2231, 93.2814, 75.4193, 26.4453, 20.4258, 12.5272, -32.2094, -52.177, -59.1076, -55.928, -65.6245, -73.3362, -79.9384, -61.3761, -48.8426, -61.4408, -61.0004, -61.8925, 37.6359, 23.5344, -13.1023, 0.800873, 41.4655, 42.9765, 67.6238, 63.2884, 3.89973, -31.3913, -13.7009, 22.1709, 52.9996, 80.9861, 104.03, 111.226, 105.321, 101.293, 95.3131, 86.3268, 2.53662, -48.4856, -49.396, -46.1962, -46.8113, -55.5073, -72.0158, -55.5526, -51.1964, -52.9002, -68.4992, -69.451, 33.7486, 19.9808, -17.4759, 29.4451, 32.2632, 23.9262, 59.5955, 61.2341, 43.8031, 57.5054, 85.1798, 105.991, 102.955, 109.92, 110.009, 109.209, 95.2332, 90.2362, 100.313, 110.397, 46.5497, -34.4245, -39.349, -49.0985, -31.7413, -44.4301, -76.0637, -59.7801, -54.5633, -65.294, -74.0653, -74.2236, 25.7469, 18.1227, -7.14597, 10.7771, 38.8009, 69.7037, 95.4687, 101.044, 95.5359, 87.2173, 68.0058, 65.8295, 59.9022, 12.844, 54.8419, 108.068, 96.1581, 77.1768, 66.2797, 74.3363, 62.5454, -5.33781, -42.2986, -37.097, -40.8271, -62.5995, -73.3383, -48.2278, -58.1774, -64.0082, -74.8449, -69.1779, 15.737, 25.2434, 15.1592, 63.1952, 100.412, 96.3217, 68.1749, 57.911, 41.5346, 22.3328, 5.03908, 25.834, 18.9612, -68.0606, 16.8828, 117.12, 105.242, 105.184, 85.1403, 72.2951, 18.6611, 3.85042, -26.1157, -27.0425, -42.9313, -60.849, -53.7108, -52.6362, -76.6718, -66.6398, -69.6471, -53.1156, 21.7426, 39.3518, 38.5349, 55.7289, 48.0338, 36.0099, 12.9913, 13.9977, 11.722, 5.52066, -0.777, 32.0191, -2.74036, -59.7763, 5.14406, 86.3383, 106.457, 110.284, 111.157, 111.342, 45.5835, -8.23832, -3.25398, -23.1968, -43.1872, -61.2976, -55.2369, -48.1509, -70.2363, -68.2919, -54.4229, -44.9889, 45.9443, 43.6761, 14.9781, -3.63592, 0.662018, -4.17794, -15.1087, -17.0277, -31.2016, -45.3906, -57.5663, -39.6497, -26.4129, -18.3927, 1.4973, 24.5635, 57.6588, 95.4937, 110.378, 114.494, 54.5825, -21.2155, -19.1547, -28.2627, -54.3404, -67.5791, -54.6699, -59.6459, -54.7771, -51.9002, -57.1203, -53.7987, 67.22, 31.0792, -16.5265, -23.0204, -39.6083, -61.4736, -63.3489, -75.121, -83.1406, -78.2961, -56.3665, -22.3107, 24.9532, 27.9062, -29.2193, -2.16368, 23.7316, 40.5549, 81.507, 115.623, 77.7272, 29.8028, -0.196899, -9.43016, -28.4999, -38.7498, -43.0376, -69.1287, -62.2781, -40.4143, -51.7504, -61.5283, 14.5307, -19.4543, -54.0301, -64.4674, -53.0475, -27.8232, 16.3899, 7.79326, -3.09348, 19.7973, 52.836, 74.8073, 63.9121, 30.8791, -57.217, -46.336, -0.550842, 66.2939, 74.2371, 117.29, 73.4978, -25.4495, 22.3844, 38.1596, -23.9878, -51.2585, -55.5052, -73.7386, -80.7836, -44.9264, -52.3336, -71.2327, -53.4231, -12.3085, -7.76716, -9.15446, 28.2671, 56.6102, 59.8569, 51.41, 31.6292, 39.6197, 70.687, 83.5553, 58.4763, 28.4741, -56.5404, -61.6459, -25.9226, 84.9255, 116.725, 120.733, 64.9735, -71.9099, -25.9463, 45.8154, 11.4641, -36.9246, -69.1286, -60.3957, -53.4243, -46.6402, -68.0992, -80.1413, -72.3685, 24.7919, 46.377, 47.047, 61.558, 48.8475, 31.1697, 38.6395, 30.0236, 39.2887, 65.1816, 76.0852, 51.1059, 28.0386, -35.0413, -46.144, -13.2792, 85.4838, 117.24, 122.257, 80.3977, -41.4762, -25.427, 35.3235, 45.9667, 28.5212, -41.747, -58.9239, -26.0764, -34.3496, -41.8135, -57.0275, -53.2953, 26.0272, 25.6958, 42.4012, 60.8221, 50.009, 45.3647, 46.8465, 37.4061, 40.7355, 56.6156, 70.5068, 46.4123, 33.2977, -7.74746, -25.9024, 5.01876, 89.8541, 108.639, 119.701, 85.8607, -34.019, -18.136, 23.6375, 13.3183, 33.9791, 30.712, -1.52946, -7.73564, -29.042, -42.5374, -39.908, -19.1401, 29.2282, 16.0533, 31.8269, 64.2133, 57.2573, 56.4955, 44.9404, 40.5394, 48.8083, 64.7597, 85.5264, 55.4733, 38.4234, -10.6385, -22.7404, 15.129, 91.0909, 105.954, 117.969, 90.2367, -30.6795, -29.8508, 22.8534, 16.5414, 12.3364, 30.0662, 45.7716, 14.5323, -30.7806, -52.4191, -45.8295, -14.9153, 26.5247, 4.32312, 26.9986, 47.358, 40.3503, 27.6261, 28.0635, 35.4788, 59.5937, 76.5708, 95.3561, 71.4206, 52.521, 16.4598, -8.5709, 6.43364, 86.393, 108.283, 117.322, 94.3475, -12.6601, -22.6764, 19.9658, 26.8031, 25.6749, 15.3573, 19.2421, 40.0002, 22.6192, -48.1837, -64.7118, -19.9477, 21.7059, 5.49316, 29.0475, 64.2771, 73.4669, 75.8089, 60.1249, 45.3188, 55.5218, 95.668, 124.629, 127.589, 111.649, 78.7053, 56.8479, 64.9545, 101.976, 115.752, 118.615, 95.5464, -1.35186, -15.2826, 21.4937, 30.3147, 23.1621, 28.9472, 18.8065, 17.4799, 37.9524, 23.1017, -46.6528, 31.7551, 81.53, 55.4504, 74.1299, 109.515, 131.849, 133.055, 117.184, 107.595, 108.974, 120.308, 134.339, 143.187, 123.28, 59.3309, 89.6136, 121.742, 116.727, 119.48, 116.24, 98.272, 4.44858, -14.6773, 19.1841, 33.9772, 25.7323, 32.4139, 15.2133, 19.7544, 23.172, 34.3102, 7.30038, 72.4561, 129.349, 118.468, 133.342, 133.949, 135.373, 140.562, 142.759, 143.361, 143.654, 141.891, 137.981, 139.878, 115.92, 91.1971, 102.593, 108.726, 112.771, 116.636, 115.483, 99.3641, 7.42142, -13.7614, 12.0255, 31.8014, 28.4025, 36.0443, 6.71884, -22.8857, 25.3708, 22.2695, 9.00884, 84.153, 137.269, 135.641, 139.735, 140.439, 141.93, 143.11, 142.351, 140.929, 140.285, 142.499, 137.645, 139.682, 119.678, 111.099, 109.481, 113.819, 115.981, 115.848, 116.597, 102.303, 14.1286, -13.0833, 7.67538, 30.4933, 33.1299, 39.7246, 11.2693, -30.5335, 3.50442, 30.1928, 8.7706, 102.727, 143.074, 133.789, 131.086, 125.91, 115.474, 109.686, 104.806, 103.23, 98.6368, 92.917, 83.0297, 70.2784, 68.4243, 83.8239, 100.107, 120.485, 126.694, 120.57, 116.285, 100.035, 23.6816, -17.5426, -2.83632, 25.9882, 31.7141, 34.3374, 19.7818, -6.16302, -6.42202, 26.9372, 20.3323, 30.2721, 45.7943, 24.7404, 6.22434, 7.30584, 2.02918, -20.763, -21.6278, 0.597717, 20.0646, 24.3091, 8.33978, -32.3689, -44.0328, -12.6483, -7.46966, 11.781, 41.9071, 65.7226, 92.5158, 93.3566, 30.0098, -2.25052, 1.51134, 23.2993, 28.9465, 33.5863, 40.9204, 26.8105, 22.3819, 27.4775, 34.758, -27.3775, 15.4249, 5.4544, -57.9036, -28.7121, -8.81336, -43.5222, -46.3856, -4.22458, 19.2015, -3.40582, 53.7211, 52.826, 45.0656, 49.451, 18.7368, -16.1688, -36.2468, -24.2913, 56.3902, 94.0935, 32.9419, 27.8496, 30.6348, 31.2925, 29.7403, 31.4251, 38.7407, 35.5967, 36.0126, 27.8352, 35.054, 66.8022, 107.856, 85.9422, -39.4069, 0.895622, 3.88258, -28.6784, -37.5099, 33.7264, 56.0583, 37.2474, 122.587, 131.771, 123.889, 124.238, 122.521, 114.518, 96.4386, 70.4569, 84.075, 75.6284, -3.34378, -11.419, -33.6985, 17.9677, 43.4046, 39.0795, 45.5356, 41.2842, 35.4058, 24.9839, 33.0068, 68.9398, 64.0616, 42.2449, -40.0883, -4.76102, -14.6908, -27.0757, -31.755, 21.5414, 33.755, 4.82186, 50.1411, 37.3833, 22.5059, 36.7339, 54.9589, 62.0049, 35.9528, 62.8464, 92.458, 11.0591, -48.9733, -54.0976, -77.25, -46.5369, -10.0161, -0.448578, 14.0315, 20.5724, 23.5164, 24.1214, 40.1446, 44.9369, -26.09, -51.8986, -59.1053, -52.7378, -50.6203, -53.8735, -55.4182, -44.1112, -36.9502, 13.1283, 63.3277, 40.4561, 0.607323, -18.1798, -20.0503, -52.0179, -93.0722, -42.1934, 71.5538, -45.6789, -67.7984, -74.8839, -78.0662, -75.3185, -71.722, -77.2031, -74.8668, -69.3605, -66.4654, -36.8785, 48.2292, 69.7925, 6.59154, -26.1265, -26.3234, -23.8603, -20.7445, -20.9231, -9.43924, -1.14312, 25.9429, 97.0011, 107.234, 80.3811, -6.4564, -53.2246, -21.1362, -50.1174, -83.1089, -82.1921, 33.5893, -4.49764, -28.6663, -11.8814, -6.26096, 2.46302, -28.9153, -65.3781, -89.2536, -91.6913, -92.7413, -65.0538, 49.168, 51.6391, 64.2625, 71.4082, 76.3018, 79.8592, 82.9818, 81.7351, 85.1955, 82.4636, 72.6217, 63.7572, 58.9684, 41.1699, -41.5904, -77.2268, -27.2341, -42.2424, -73.1995, -80.3233, -26.735, 18.1943, 22.0144, 25.598, 32.1861, 18.8642, -41.5366, -51.9875, -70.9961, -84.4558, -54.3909, -58.4895, -4.98102, 58.5305, 55.8828, 14.7783, 33.5473, 55.105, 51.2322, 35.9365, 28.4166, 23.6717, 49.8755, 63.1131, 33.4592, 26.7209, -18.0234, -25.7979, -11.816, -35.8976, -43.9778, -72.0669, -42.4242, 6.3838, 5.11892, -0.30172, 6.31234, 3.05826, -31.3973, -41.9177, -74.9443, -80.4295, -23.1857, -31.0545, -5.27678, 56.4333, 39.4805, -52.8137, -59.2893, -48.972, -51.959, -60.274, -57.9225, -28.6355, 64.6837, 90.971, 34.4565, 5.97172, -11.7713, 5.2637, -6.6832, 7.1757, 46.0288, -48.1061, -37.3958, -2.70824, -11.1143, -14.6716, -5.96, 0.785759, 1.31926, -38.3113, -73.1987, -70.5299, 14.05, 0.410362, 20.444, 46.1436, 40.9395, 22.307, 12.5799, 9.66712, 8.44034, 12.0053, 18.3294, 28.6902, 53.9714, 51.3084, 28.8569, 12.3708, -47.3745, -68.2546, -29.2641, 28.5495, 36.4072, -42.8046, -44.2339, -12.6255, -9.0315, -13.4187, -9.7845, -5.1116, 28.5652, -19.9909, -29.7379, -79.6935, -25.8184, -38.152, -18.8881, 51.8579, 48.2211, 59.2646, 53.2178, 55.9819, 62.5712, 72.0533, 78.2625, 66.5166, 52.7126, 63.0745, 65.5829, 45.9576, -24.8747, -46.7842, -24.838, -3.8444, 13.0642, -28.1631, -39.5285, -29.9864, -38.3545, -50.6284, -60.984, -51.2873, 13.5134, -44.8681, -80.4273, -96.0302, -74.8709, -54.7512, -22.1055, 13.351, 17.3066, 29.8319, 15.4347, -16.0524, -6.6856, 9.65252, 26.7356, 41.8599, 44.0101, 69.278, 69.6096, 25.8297, -14.0867, -10.1184, -34.1745, -48.0218, -15.1387, -38.2648, -57.5837, -65.9442, -80.2431, -92.5438, -101.784, -91.0046, -34.085, -53.2086, -59.5272, -38.8781, -16.2564, 7.28158, 17.3937, 4.55436, 8.0288, 19.0594, 11.3446, -81.5207, -101.46, -94.3431, -43.2556, 8.82656, -6.09936, -14.0079, -21.882, -50.7581, -82.7129, -92.8297, -91.8564, -70.7057, -64.8184, -84.9299, -102.122, -102.376, -101.572, -91.7082, -71.7163, -46.7353, -12.7785, 8.1868, 19.1359, 22.1222, 25.1694, 28.0938, 29.6181};
//			double[] floatPixels = {27.2893, 28.8596, 33.9496, 34.4311, 27.8153, 23.1482, 28.6285, 25.1091, 23.515, 24.0674, 25.766, 24.5963, 25.3798, 30.3658, 33.366, 34.3886, 31.4695, 26.4964, 24.509, 24.6165, 20.8904, 14.0417, 15.1898, 13.4734, 14.9538, 9.3931, 6.9241, 8.67525, 11.4112, 5.94098, -4.39308, -14.174, 21.9007, 21.6554, 28.7831, 35.4276, 30.8458, 28.1777, 31.6399, 29.1596, 29.6077, 22.1245, 20.7355, 24.5847, 28.3613, 35.337, 36.3594, 36.5427, 34.5934, 25.5127, 19.5326, 16.6034, 10.8455, 4.92165, 6.11176, 7.44516, 16.0326, 14.4605, 13.0596, 10.8057, 12.4586, 5.95746, -4.33038, -10.1568, 21.2753, 22.2834, 28.5265, 37.1472, 29.6384, 32.0394, 33.5186, 32.9982, 30.3483, 28.8674, 24.4502, 23.2246, 27.1457, 32.121, 33.209, 35.3797, 36.3334, 25.2532, 11.3181, -12.4993, -23.257, -35.155, -32.0029, -18.622, -12.0397, 2.43794, 11.9796, 9.57681, 12.1679, 9.78934, 1.40906, -8.59134, 25.5381, 26.6276, 30.9471, 44.4939, 37.1274, 36.6845, 38.1843, 37.551, 32.8367, 32.3338, 33.9904, 57.7907, 43.8539, 23.7746, 28.7717, 30.9679, 24.9492, 15.8941, -28.9877, -29.8254, -34.5307, -40.318, -52.2359, -57.8846, -45.3713, -47.9019, -17.3678, 2.07591, 10.5477, 11.1696, 7.7838, -1.31966, 25.7986, 27.9407, 32.3719, 40.9476, 39.7247, 33.2746, 38.7692, 35.2145, 32.5831, 32.1775, 40.7255, 113.467, 62.5758, 18.5475, 13.5119, 9.71281, -21.2409, -54.3171, -47.3153, -19.0881, -19.6672, -25.3998, -34.2534, -37.9785, -56.6182, -46.2548, -44.7783, -24.3399, -0.928604, 9.5957, 5.09026, 0.953415, 19.0939, 5.2703, 1.88176, 18.5613, 32.3835, 35.9648, 37.5245, 37.1224, 32.5387, 34.0707, 31.5872, 48.2929, 25.4498, -3.58315, -34.6233, -65.4416, -62.3679, -65.5159, -42.5959, -13.3867, -9.07381, -11.7906, -16.5732, -36.2177, -30.9505, -38.7501, -71.2972, -61.8076, -20.4239, 12.044, 10.4712, 6.2812, -1.48642, -18.2023, -80.5193, -39.7071, 25.0468, 41.7285, 39.3135, 40.9533, 39.3996, 35.8497, 33.3995, 16.1973, -1.64374, -3.65469, -30.7336, -62.6308, -52.5189, -58.6493, -47.7322, 1.42381, 15.607, -6.10139, -24.777, -22.4748, -14.226, -44.0692, -65.7139, -82.2247, -48.8525, 4.58218, 13.9675, 6.68282, 3.00488, -27.598, -84.8659, -56.9925, 15.8458, 39.4222, 37.0345, 39.8405, 42.3536, 31.7354, 10.3167, -9.7618, 0.380035, 14.2617, -13.8481, -41.7568, -38.7989, -44.9878, -53.0171, -5.79591, 33.443, 6.60175, -27.099, -22.898, -28.5315, -43.2989, -74.085, -78.6612, -70.2893, -19.8291, 11.4662, 9.1165, 42.5451, -22.961, -72.2252, -2.29102, 26.5419, 34.1157, 35.7561, 38.6913, 37.2887, 45.6724, -15.7044, -3.87337, 28.0676, 26.8932, -8.25285, -43.3737, -47.5096, -45.602, -49.5988, -48.4244, 8.98332, 17.2163, -15.6435, -41.4903, -45.1793, -41.8936, -56.5872, -71.2384, -86.7697, -52.275, 7.02718, 10.5834, 52.7716, 8.31254, -31.813, 28.1466, 47.932, 31.588, 29.1988, 26.1412, 79.7804, 109.244, 78.8557, 27.5392, 45.2518, 19.0542, -4.07996, -36.1952, -43.3607, -55.3598, -70.4574, -53.3664, 8.0932, 14.4963, 4.8226, -22.0142, -41.8222, -40.6372, -43.2777, -51.9227, -76.385, -85.8647, -30.562, 5.87824, 56.0286, -17.4094, 16.5059, 39.4349, 51.2268, 28.7896, 32.4329, -4.79194, 85.9364, 109.647, 92.0605, 35.6696, 54.4829, 27.1804, -4.03979, -9.20895, -51.2378, -49.2914, -84.412, -38.2725, 46.1194, 28.5962, 27.0659, -20.7111, -40.443, -24.2209, -38.9408, -48.4681, -66.9212, -84.4126, -66.1433, -21.7896, 61.3223, -24.9761, 9.9416, 44.8444, 61.5082, 39.8852, 46.5226, 7.36686, -9.7897, 66.9012, 71.2212, 41.7516, 56.4067, 60.0181, 4.78632, -12.4717, -27.4726, -45.4636, -91.4916, -4.18388, 81.2742, 31.7368, 18.0597, -34.5822, -44.2339, -32.8935, -22.5718, -41.0424, -52.4111, -69.9498, -62.7742, -49.4704, 62.6444, -34.603, 2.40696, 50.3494, 48.9317, 40.1473, 51.6382, 32.4267, -29.7097, 40.8125, 40.0509, 8.40486, 57.0142, 86.674, 30.4284, -6.7903, -9.88206, -14.8224, -79.7505, 20.5744, 65.2049, 26.6381, -5.06207, -36.6784, -43.3014, -42.7926, -31.3322, -39.7571, -41.0174, -51.5346, -45.515, -52.2156, 63.1057, -31.0772, 27.87, 60.6445, -5.86118, 10.315, 46.7945, 40.4718, -23.8992, 19.4234, 16.62, 37.8754, 59.5226, 96.3044, 50.0515, 10.9215, -4.11398, -13.1359, -59.0455, 24.281, 56.7164, 20.214, -14.2387, -40.8163, -47.2199, -54.5997, -46.09, -26.2802, -24.5173, -34.0526, -27.1222, -30.9167, 68.368, -15.6055, 44.2813, 61.866, -19.8045, -26.4875, 30.0213, 40.502, -27.1803, -12.798, 9.56984, 68.9599, 60.4492, 42.1885, 15.063, 24.0636, 16.037, -27.0382, -59.047, 22.1391, 49.5341, 8.23438, 1.98788, -17.3467, -41.7274, -35.0769, -30.4109, -15.6017, -8.94634, -23.5893, -26.6594, -7.65076, 71.3658, 8.4944, 48.5242, 60.2404, 5.66372, -46.9477, 14.393, 28.6491, -11.8184, 2.66918, 15.1652, 101.608, 113.006, 15.7878, 5.66367, 1.82668, -8.2184, -21.3444, -34.4259, 14.6938, 39.2261, 23.9865, -15.4004, -39.663, -54.9778, -38.335, -19.6544, -11.8742, -3.3814, -20.0502, -2.11056, 11.6769, 77.482, 22.7196, 44.9519, 67.8732, 44.5061, -46.0754, 1.17706, 12.4759, 12.1887, -30.4, 27.001, 45.5075, 33.9314, 11.6711, -15.2647, -14.988, -26.9431, -22.962, -15.9541, 43.2116, 28.6154, 21.2615, 8.80532, -16.5627, -46.804, -45.2279, -29.5252, -21.8358, -15.5285, 2.6121, 28.3061, 19.87, 88.6899, 40.1653, 41.6745, 60.8794, 53.5939, -28.9078, -27.7155, 31.6034, 23.3019, -19.1777, 3.31668, -8.09868, -12.5935, -10.9652, -24.7244, -11.4599, -40.2147, -25.0274, 18.0269, -7.8711, -57.6172, 2.79184, 8.26552, -49.2043, -63.4696, -64.8496, -51.2441, -19.706, -5.54946, 21.3656, 27.8282, 16.24, 86.8126, 55.595, 45.4865, 51.9119, 54.7868, 2.3465, -36.3961, 17.9222, 29.4931, 11.138, -20.1832, -47.587, 9.15542, -1.17578, 4.04186, 22.2833, -39.4649, -32.2342, 25.8556, 7.94234, -6.80794, -16.5878, -48.1361, -58.7269, -78.0695, -56.4284, -34.8813, 12.4637, 34.4198, 39.0563, 32.2385, 27.4062, 73.9519, 64.9562, 50.1421, 53.7374, 56.924, 23.7111, -34.9277, -2.50116, -0.0716782, 14.676, 21.4011, -53.0113, 5.80878, -15.2701, 21.89, 61.0623, -6.75966, -49.6414, 8.4077, 14.566, 11.8167, -33.0171, -70.6562, -69.2354, -73.6816, -30.1361, 1.36322, 43.4642, 51.1602, 43.603, 36.5129, 25.4623, 39.9356, 73.2435, 58.6162, 57.4202, 61.794, 32.9011, -20.5747, 10.8711, 50.327, -17.8735, -27.9726, -41.2575, -28.5053, 0.40126, 56.5958, 69.8176, 28.824, -21.2515, -32.0597, -33.9815, -60.8948, -74.6623, -82.2756, -95.9429, -73.5874, -59.3126, -10.8146, 25.216, 24.876, 8.10928, 5.6442, -3.5563, -8.15358, 73.4457, 56.9507, 58.8723, 62.4212, 19.7011, -35.551, 30.9864, 125.589, 99.4147, 13.1886, 14.1336, 29.0492, 55.8757, 70.0918, 74.3262, 48.1938, 5.10612, -9.69716, -58.7329, -84.8111, -85.4957, -70.1972, -60.9369, -57.6754, -60.5023, -49.101, -45.9879, -40.4858, -50.6307, -62.4122, -68.834, -46.1168, 53.5672, 54.169, 57.2016, 58.8682, 22.311, -8.67034, 93.1145, 134.842, 133.565, 89.319, 5.30896, -4.68884, 5.25212, -2.62102, 3.5141, -14.5616, -50.6365, -50.6552, -58.7841, -66.8524, -68.6092, -67.3895, -62.0415, -61.8283, -66.6883, -74.4868, -66.4178, -59.1862, -71.6012, -78.4304, -81.9261, -84.2392, -25.7229, 23.9064, 49.182, 59.9854, 47.5521, 47.7662, 128.711, 135.523, 109.235, -7.94186, -57.9198, -64.9366, -68.8469, -68.7451, -69.7507, -72.8481, -75.9433, -72.0001, -75.9805, -79.9007, -71.8224, -71.6794, -74.4556, -75.2711, -71.1729, -71.0457, -67.1761, -63.0876, -66.5946, -70.5204, -78.9778, -96.495, -93.1103, -61.3272, 12.0211, 48.0001, 14.6, 76.8973, 136.916, 123.778, 23.4812, -56.6624, -67.5322, -67.4318, -66.3114, -68.1802, -67.2104, -70.2619, -75.2709, -78.3023, -83.3309, -82.1723, -78.2181, -79.2828, -75.3285, -72.2016, -61.1291, -55.029, -58.4411, -62.3907, -69.9236, -75.7955, -73.1316, -77.7037, -92.4357, -86.7496, -46.3063, 9.85032, 10.4917, 97.7741, 137.824, 69.6702, -51.5352, -63.58, -67.4477, -65.261, -65.0647, -70.7763, -71.8666, -73.9141, -75.8456, -80.8969, -78.218, -77.1514, -77.2575, -74.4934, -71.5739, -58.5206, -55.5082, -53.5073, -59.0324, -65.071, -70.5682, -52.2479, -41.3164, -73.8242, -87.8493, -90.3753, -79.0146, -52.8125, 9.8718, 106.164, 122.278, 6.15788, -59.9535, -68.893, -61.5902, -63.3226, -73.0781, -72.9207, -70.0359, -71.1418, -74.196, -74.1844, -73.4373, -73.5553, -72.7604, -64.0391, -60.2004, -64.1332, -72.1912, -75.32, -82.8877, -69.0064, -48.3672, -37.8427, -48.6316, -75.9441, -88.2896, -92.9855, -85.8055, -75.8433, -41.2708, 83.02, 92.1045, -21.8771, -53.8273, -64.7035, -70.2548, -59.756, -69.5276, -77.562, -72.556, -70.7194, -69.8409, -70.8582, -72.0374, -67.2857, -79.6644, -80.1175, -71.243, -72.2087, -80.3334, -91.6423, -80.1276, -54.1321, -55.1768, -77.4244, -73.9083, -76.2483, -88.8529, -90.8868, -88.9353, -80.2245, -74.8807, -16.6545, 49.4539, -56.3783, -66.2942, -68.0872, -66.6153, -58.1641, -60.9588, -64.9045, -73.8754, -77.0778, -78.1923, -73.318, -70.6594, -73.9855, -78.3429, -80.5811, -81.7986, -83.9416, -80.9941, -77.2579, -58.649, -75.3334, -92.1184, -109.02, -74.2559, -58.5537, -82.5884, -92.9251, -85.2597, -85.8828, -79.6783, -80.4769, -51.456, -73.4068, -91.379, -95.1156, -83.7014, -72.4368, -65.3421, -63.2693, -68.2547, -65.2429, -61.3108, -64.4786, -68.7763, -72.122, -77.377, -83.5013, -89.7266, -80.9315, -60.9448, -44.058, -50.3184, -67.7094, -86.2404, -111.689, -85.5167, -66.0681, -76.469, -90.2849, -81.9588, -85.8299, -82.8164, -80.7137, -84.8278, -82.9242, -97.9129, -101.741, -94.495, -97.3679, -95.4041, -88.4435, -77.4286, -68.266, -62.3215, -58.382, -49.6423, -55.922, -76.0744, -82.2142, -82.3306, -65.4396, -40.3506, -16.2136, -32.2609, -65.3959, -99.4925, -96.5861, -105.997, -73.7347, -70.598, -81.8652, -83.8798, -87.0942, -87.3264, -87.4329, -89.5439, -91.6767, -101.746, -105.757, -98.72, -102.695, -98.7794, -108.919, -109.902, -95.7275, -80.7778, -66.8326, -53.9499, -62.1191, -75.182, -76.1396, -83.0022, -60.9012, -38.7712, -22.5215, -38.2832, -79.0634, -102.778, -92.565, -105.639, -24.0561, -24.4424, -20.2462, -18.678, -25.2286, -28.8545, -23.2839, -25.7407, -28.2752, -26.6326, -23.941, -29.0906, -29.2688, -23.2617, -23.2254, -21.1721, -23.0933, -27.0614, -29.0535, -27.9609, -30.7138, -32.6188, -32.4984, -33.2973, -31.9465, -37.5873, -40.1072, -40.4154, -39.7739, -41.307, -44.7085, -50.4736, -23.2948, -24.4591, -21.1767, -19.4306, -23.918, -23.4865, -19.8891, -23.2821, -21.7393, -28.1193, -27.4895, -28.6066, -25.8128, -19.8178, -21.7516, -23.546, -23.5047, -27.5408, -26.5122, -23.4853, -28.2871, -34.2882, -36.1658, -37.9297, -32.4783, -35.1335, -34.6023, -38.9791, -37.4965, -40.1386, -43.559, -46.3837, -24.6482, -24.4975, -23.0555, -23.2776, -28.5985, -20.0099, -18.3953, -18.784, -21.3051, -21.6762, -23.0382, -28.2144, -26.2921, -22.314, -23.1742, -23.9465, -20.9696, -22.9973, -25.9236, -40.8206, -46.6476, -58.6446, -59.5919, -51.3223, -49.906, -39.5319, -32.0987, -35.6961, -35.3413, -35.9582, -38.5415, -44.5577, -27.0864, -22.816, -24.2199, -21.4379, -23.5468, -16.7125, -13.9784, -15.4302, -20.0223, -18.4083, -12.6643, 10.1882, -5.7364, -24.7934, -20.7498, -21.4658, -23.4342, -24.4444, -55.3389, -48.2676, -45.0552, -44.9589, -59.9943, -71.7853, -64.4709, -72.1811, -48.8307, -35.6277, -31.438, -32.1329, -33.7837, -38.9538, -26.5223, -18.1451, -17.3856, -18.475, -18.3591, -19.4714, -12.6474, -16.9511, -20.3858, -17.6593, -6.02502, 79.7785, 21.9229, -20.0757, -23.0788, -25.7913, -53.6991, -80.7587, -64.7891, -30.6386, -23.3075, -19.1458, -31.1573, -39.0879, -60.9417, -54.8279, -59.6292, -49.4901, -36.3921, -31.2305, -38.0755, -39.3611, -23.9196, -27.4507, -31.428, -19.3476, -16.1211, -18.1477, -15.2013, -16.2427, -20.5412, -15.8074, -14.1769, 5.6011, -10.1617, -30.1448, -57.1563, -81.9128, -73.8373, -76.009, -49.1077, -18.9394, -10.7425, -9.60976, -15.6318, -35.5338, -31.5113, -40.6295, -73.5353, -73.4341, -47.4101, -26.3547, -33.3205, -36.7099, -32.1862, -35.5925, -93.4095, -56.1221, -12.9144, -11.7801, -14.6977, -11.6232, -12.8142, -14.0143, -10.2255, -23.3389, -32.1327, -22.0612, -43.1019, -62.9763, -46.9216, -55.0934, -46.1974, -0.104187, 11.932, -11.9455, -30.8998, -27.9307, -19.0035, -47.2618, -59.3403, -83.2899, -69.3729, -32.4293, -31.4579, -37.9687, -16.4014, -33.64, -86.3495, -64.9517, -17.6231, -11.5048, -14.3094, -12.0109, -9.03011, -15.1982, -19.2906, -34.2321, -18.0133, 2.98584, -22.0517, -40.9456, -33.066, -40.2843, -51.367, -10.2604, 24.7953, -4.22321, -35.2406, -30.4345, -35.5, -47.7516, -69.0508, -76.127, -82.2675, -46.379, -26.5361, -33.1658, 30.4657, -23.6187, -70.2916, -6.8015, -3.44894, -14.256, -9.97522, -4.47394, -5.30814, 8.5568, -37.428, -21.3919, 14.7201, 16.7488, -15.2797, -46.378, -45.5883, -41.7569, -48.8669, -55.8483, -1.66094, 8.349, -23.8735, -48.1366, -50.3256, -45.6053, -54.8901, -71.1187, -93.1748, -69.3042, -22.5565, -26.3342, 46.0729, 11.0549, -27.4739, 27.0998, 22.4502, -10.2309, -9.91292, -7.27852, 55.0164, 89.0278, 55.0809, 6.05532, 28.0408, 6.1126, -14.8433, -39.9111, -41.1771, -51.3049, -68.5372, -57.6158, -0.46946, 7.58572, -1.50178, -27.8047, -45.2303, -41.6687, -41.9415, -51.2078, -78.2324, -97.4169, -52.769, -25.6809, 53.6722, -11.2876, 24.2598, 42.868, 30.292, -13.4427, -7.05122, -35.4995, 72.9967, 100.366, 67.3217, 11.3243, 35.4656, 13.4686, -15.5515, -12.6237, -47.7437, -43.916, -80.2063, -39.3213, 40.689, 22.7108, 22.6976, -24.6323, -42.0464, -23.5293, -37.9002, -47.0949, -67.2346, -90.4978, -80.9156, -47.0091, 62.3122, -18.4723, 18.1481, 49.797, 42.1577, -4.67934, -1.24794, -30.6133, -27.9074, 59.5618, 48.5379, 19.5491, 38.5675, 48.5474, -3.45078, -15.5736, -24.6461, -38.7797, -85.043, -2.08134, 77.9269, 28.92, 15.7292, -34.5915, -43.9728, -31.3677, -20.7569, -38.0065, -50.1864, -72.5383, -71.0349, -71.2903, 66.0359, -29.6658, 9.1163, 55.8649, 32.225, -0.71714, -0.386124, -13.7366, -53.9814, 32.4005, 22.4073, -7.72194, 44.3256, 80.413, 27.4377, -8.63254, -7.7748, -7.82046, -71.9977, 24.9226, 65.0632, 27.0236, -4.25494, -34.6778, -40.1045, -39.3969, -28.7521, -37.0448, -37.2335, -51.6091, -51.299, -71.6146, 64.8456, -29.7583, 30.0357, 64.718, -12.9258, -16.8781, 1.51536, -5.86888, -49.3019, 10.9555, 3.99328, 27.8425, 52.9829, 95.2379, 51.2658, 10.2608, -3.7726, -6.8309, -49.9764, 30.9465, 59.8632, 22.7467, -11.3817, -36.8263, -42.1088, -49.357, -42.7523, -22.9019, -22.134, -35.6057, -35.4689, -52.9391, 69.3917, -16.9504, 43.8808, 63.47, -13.2634, -33.0166, -2.54828, 0.90818, -46.7781, -14.4135, 2.83508, 64.8801, 59.8997, 45.102, 20.2216, 23.3729, 16.4349, -19.6201, -48.9052, 31.8554, 54.6945, 12.6931, 7.67044, -11.5721, -34.8147, -28.0974, -25.4032, -11.6171, -5.98106, -26.6297, -38.5747, -30.3133, 70.7206, 5.54996, 44.5606, 56.2998, 15.7226, -37.8707, -0.572701, 4.6416, -25.8269, 0.676559, 12.1132, 102.263, 117.182, 19.4105, 11.5582, 2.86024, -6.10836, -14.2148, -30.5666, 15.0804, 40.0211, 28.1206, -11.0657, -34.2332, -47.4453, -31.7718, -16.1228, -11.4037, -10.9493, -35.6675, -26.6676, -20.6748, 77.1239, 23.1149, 42.3645, 61.3168, 49.9515, -33.5795, 5.65928, 6.90284, 2.61284, -37.9767, 25.3679, 45.5998, 34.554, 14.7074, -10.9046, -10.4862, -15.4376, -15.4631, -26.7117, 26.0093, 20.8053, 23.7844, 12.5638, -12.6831, -41.8988, -39.3117, -25.6635, -28.0409, -36.7693, -32.6925, -13.9329, -20.2038, 89.5544, 43.792, 46.3012, 64.5185, 63.2536, -16.2155, -21.9923, 31.2616, 19.8862, -23.6536, -0.277397, -10.9922, -13.953, -10.8963, -24.3817, -4.97102, -23.696, -11.5572, 13.2434, -19.0935, -59.4452, 4.28178, 10.0315, -47.2472, -60.4629, -60.8107, -47.201, -24.6977, -24.6002, -7.74368, -5.2073, -13.6493, 85.8728, 62.3916, 55.2819, 62.6772, 66.5325, 14.1268, -28.6151, 22.5647, 31.9993, 12.5211, -25.0468, -50.8145, 6.42452, -3.45848, 3.03154, 29.365, -21.3343, -17.1537, 25.6802, 3.34422, -4.96598, -15.3898, -46.6475, -55.9771, -74.1747, -53.4128, -46.7886, -11.409, 1.52968, 1.09152, -5.67934, -12.3348, 67.1834, 67.9211, 57.0592, 61.5936, 65.7106, 33.4723, -25.2443, 5.9833, 9.22596, 21.7426, 20.0826, -54.7665, 4.53566, -16.1498, 21.2751, 63.4975, 5.6869, -37.2243, 6.56386, 11.326, 16.0733, -27.3469, -64.6236, -62.8634, -65.048, -24.3527, -23.7429, 2.5152, 4.29704, -5.31236, -9.32026, -16.1158, 31.3214, 72.322, 59.5771, 56.2843, 65.5188, 42.4782, -11.1585, 20.9967, 61.1717, -8.369, -22.927, -35.6827, -22.5056, 5.7351, 61.1344, 70.392, 36.4186, -11.6812, -33.7063, -35.0339, -51.404, -60.6572, -66.7887, -80.0053, -56.3067, -42.8087, -14.1495, 10.1064, 6.90002, -8.86522, -7.14932, -18.014, -4.63134, 79.5854, 59.8972, 52.6254, 63.9647, 30.0094, -26.5168, 39.6409, 133.877, 109.278, 27.5224, 28.9651, 44.2561, 70.3869, 84.7561, 80.9982, 60.8796, 21.7712, -2.19148, -49.5796, -63.0651, -58.1664, -42.3169, -31.5637, -27.8596, -29.3628, -14.7033, -13.3291, -11.6489, -21.686, -28.2136, -33.2375, -19.5601, 76.7033, 65.0512, 55.8052, 62.1632, 32.2703, -1.0864, 98.2525, 139.552, 140.784, 111.902, 31.343, 20.6937, 29.8788, 22.1427, 22.338, 13.2648, -17.8336, -23.973, -29.4016, -27.8389, -27.9935, -27.1751, -19.2845, -18.5481, -21.9864, -17.4322, -10.0291, -7.54702, -20.7244, -23.2388, -28.2807, -35.6502, 16.4187, 49.7316, 57.6274, 67.0261, 56.1345, 52.9079, 132.36, 138.657, 118.816, 23.9756, -23.6268, -31.3589, -35.1214, -35.8916, -38.7709, -31.8491, -29.9751, -30.1445, -29.4404, -25.7411, -21.9704, -23.1191, -25.3053, -23.5542, -19.936, -19.362, -18.0669, -19.6209, -23.8419, -25.3851, -33.3501, -33.8724, -34.0095, -16.6438, 36.2284, 63.7436, 21.8323, 75.6329, 137.112, 132.377, 46.4836, -18.3436, -27.9159, -27.6126, -26.377, -28.1097, -27.018, -25.0668, -27.0931, -29.255, -32.5628, -28.7537, -26.0411, -27.3433, -23.7385, -20.9906, -10.3277, -10.6849, -13.601, -14.1323, -19.3103, -26.7288, -20.5346, -14.0938, -27.4081, -34.2331, -11.3256, 32.2796, 21.3874, 99.1086, 139.554, 84.7829, -20.0399, -21.8197, -24.4569, -22.0834, -21.7408, -28.3092, -29.3172, -29.4008, -30.3593, -31.538, -29.0773, -26.2868, -23.5957, -21.0809, -18.5219, -5.79828, -4.1383, -5.49486, -7.50678, -9.06116, -14.0771, 1.75256, 13.2655, -11.2329, -22.8856, -33.9848, -35.2353, -21.6573, 29.4468, 114.124, 130.569, 28.788, -21.9978, -26.7211, -19.2392, -20.78, -30.3854, -30.1105, -29.1508, -28.2789, -29.3907, -26.5223, -24.9645, -23.2997, -16.6928, -8.19542, -4.6457, -9.8597, -18.2358, -20.6584, -25.6694, -10.2186, 9.99542, 16.0929, 0.9496, -15.3432, -24.381, -31.7164, -33.2062, -34.9192, -10.9812, 102.653, 111.971, 10.2587, -11.4272, -21.1053, -27.4909, -16.8219, -26.4546, -33.3868, -31.3267, -29.5025, -26.6944, -24.8408, -25.1742, -17.5951, -23.1257, -22.7788, -14.1253, -15.3488, -23.7545, -32.3011, -17.1301, 9.52084, 5.08544, -24.5203, -28.3178, -17.6513, -25.9676, -29.6949, -32.4882, -31.4777, -34.8073, 14.7015, 79.0115, -17.6315, -20.3482, -22.9508, -21.3192, -12.6958, -15.3845, -19.2402, -32.2197, -36.4539, -35.6059, -27.8128, -24.2761, -24.7584, -22.2882, -24.7248, -26.129, -28.4557, -25.7366, -17.2171, 5.1516, -10.7834, -31.9034, -63.1382, -31.659, -1.9533, -23.7335, -34.8011, -30.9448, -34.2876, -31.7904, -41.354, -13.1661, -30.9557, -42.7563, -48.325, -36.7539, -25.3115, -18.1333, -16.0236, -26.0377, -24.0787, -19.1873, -19.4132, -21.7842, -24.2863, -25.7477, -32.0397, -37.4213, -29.7451, -8.91378, 10.7947, 9.33646, -6.22448, -26.0034, -59.7463, -39.8601, -10.3762, -22.5832, -39.1869, -32.7147, -33.3643, -31.096, -34.8045, -41.779, -37.7117, -50.5552, -55.2307, -47.8509, -50.6009, -48.5416, -41.5746, -35.5908, -26.4618, -20.5692, -12.6761, -3.00386, -9.4018, -27.7063, -35.0089, -35.2612, -18.479, 6.4589, 32.4076, 21.2011, -9.0521, -42.3376, -42.6484, -61.2858, -19.9478, -20.6533, -36.7568, -39.6221, -36.661, -33.7143, -38.6649, -44.6494, -46.6554, -56.5873, -59.4671, -52.3349, -56.2397, -52.2392, -62.365, -67.3582, -55.1983, -38.2712, -21.3653, -6.55222, -14.8199, -29.9935, -31.0899, -39.0803, -17.0799, 4.89462, 19.959, 9.04266, -26.852, -48.6971, -41.6174, -58.8503, -83.5538, -84.8536, -81.5814, -79.8775, -87.2674, -92.7803, -87.155, -89.5227, -91.0142, -94.2914, -94.51, -83.659, -86.8157, -94.8078, -90.7769, -91.7186, -95.5807, -97.5547, -96.5742, -92.4728, -91.2094, -90.177, -90.1076, -91.928, -90.6245, -95.3362, -90.9384, -92.3761, -94.8426, -96.4408, -96.0004, -98.8925, -80.3641, -90.4656, -86.1023, -75.1991, -82.5345, -89.0235, -85.3762, -87.7116, -87.1003, -95.3913, -92.7009, -79.8291, -82.0004, -93.0139, -93.9701, -100.774, -103.679, -100.707, -92.6869, -83.6732, -80.4634, -78.4856, -81.396, -85.1962, -82.8113, -86.5073, -87.0158, -93.5526, -97.1964, -99.9002, -98.4992, -96.451, -83.2514, -96.0192, -93.4759, -81.5549, -87.7368, -86.0738, -85.4045, -85.7659, -88.1969, -88.4946, -83.8202, -75.0089, -81.0447, -94.0798, -94.9908, -96.7908, -92.7668, -84.7638, -77.687, -82.6034, -79.4503, -81.4245, -84.349, -81.0985, -82.7413, -75.4301, -79.0637, -90.7801, -94.5633, -95.294, -95.0653, -96.2236, -89.2531, -95.8773, -97.146, -84.2229, -85.1991, -82.2963, -80.5313, -80.9562, -85.4641, -84.7827, -72.9942, -35.1705, -55.0978, -89.156, -83.1581, -75.9323, -71.8419, -62.8232, -82.7203, -64.6637, -53.4546, -45.3378, -63.2986, -79.097, -76.8271, -89.5995, -83.3383, -82.2278, -85.1774, -89.0082, -88.8449, -92.1779, -87.263, -78.7566, -77.8408, -79.8048, -83.5877, -86.6783, -79.8251, -83.089, -86.4654, -85.6672, -68.9609, 35.834, -21.0388, -72.0606, -68.1172, -56.8805, -77.7579, -96.8161, -71.8597, -29.7049, -16.3389, -9.14958, -22.1157, -34.0425, -59.9313, -56.849, -79.7108, -81.6362, -78.6718, -80.6398, -90.6471, -91.1156, -73.2574, -61.6482, -68.4651, -72.2711, -80.9662, -85.9901, -84.0087, -84.0023, -88.278, -86.4793, -83.777, -40.9809, -47.7404, -67.7763, -82.8559, -94.6617, -82.5431, -80.716, -49.8434, -15.6585, -5.41646, -3.23832, -9.25398, -29.1968, -28.1872, -39.2976, -78.2369, -88.1509, -76.2363, -67.2919, -81.4229, -85.9889, -69.0557, -44.3239, -107.022, -95.6359, -75.338, -80.1779, -83.1087, -80.0277, -81.2016, -86.3906, -84.5663, -71.6497, -64.4129, -48.3927, -53.5027, -66.4365, -51.3412, -59.5063, -49.6222, -2.5062, 8.58252, -15.2155, -33.1547, -29.2627, -20.3404, -46.5791, -54.6699, -84.6459, -87.7771, -65.9002, -76.1203, -85.7987, -34.78, -30.9208, -84.5265, -81.0204, -65.6083, -79.4736, -85.3489, -82.121, -72.1406, -70.2961, -70.3665, -72.3107, -44.0468, -14.0938, -28.2193, -42.1637, -33.2684, -39.4451, -52.493, -14.3768, 18.7272, -9.19718, -40.1969, -33.4302, -37.4999, -47.7498, -64.0376, -73.1287, -90.2781, -72.4143, -71.7504, -84.5283, 20.5307, -16.4543, -62.0301, -7.4674, -38.0475, -76.8232, -78.6101, -69.2067, -53.0935, -24.2027, -60.164, -41.1927, 1.9121, 8.87914, -18.217, -45.336, -42.5508, -37.7061, -46.7629, -58.7101, -7.5022, 3.55054, -26.6156, -49.8404, -50.9878, -44.2585, -53.5052, -67.7386, -93.7836, -85.9264, -62.3336, -77.2327, 40.5769, 22.6915, -14.7672, 29.8455, -6.7329, -67.3898, -71.1431, -57.59, 28.6292, 80.6197, 48.687, 1.55534, 27.4763, 7.47412, -10.5404, -38.6459, -38.9226, -47.0745, -65.2753, -60.2674, -6.0265, 4.09012, -3.94632, -29.1846, -44.5359, -40.9246, -41.1286, -48.3957, -76.4243, -104.64, -76.0992, -64.1413, 53.6315, 2.79192, 39.377, 50.047, 4.55804, -67.1525, -65.8303, -69.3605, 63.0236, 110.289, 72.1816, 15.0852, 39.1059, 16.0386, -12.0413, -12.144, -47.2792, -39.5162, -76.7595, -39.7427, 37.3977, 20.5238, 21.573, -24.6765, -40.0333, -21.4788, -38.747, -44.9239, -59.0764, -85.3496, -87.8135, -74.0275, 68.7047, -1.97284, 35.6958, 61.4012, 19.8221, -56.991, -60.6353, -71.1535, -34.5939, 73.7355, 49.6156, 18.5068, 36.4123, 44.2977, -8.74746, -19.9024, -25.9812, -36.1459, -81.3609, -2.29942, 76.8607, 26.981, 14.864, -33.3625, -40.6817, -28.0209, -22.288, -35.5295, -38.7356, -62.042, -69.5374, -92.908, 74.8599, -11.7718, 28.0533, 69.8269, 18.2133, -46.7427, -61.5045, -67.0596, -69.4606, 38.8083, 12.7597, -19.4736, 34.4733, 69.4234, 15.3615, -15.7404, -8.87102, -4.90914, -67.0463, 25.9689, 64.2367, 26.3205, -2.85082, -31.1466, -35.4586, -34.6636, -29.9338, -34.2284, -26.4677, -42.7806, -52.4191, -93.8295, 75.0847, -12.4753, 48.3231, 77.9986, -15.642, -47.6497, -55.3739, -62.9365, -73.5212, 7.59368, -9.42922, 14.3561, 42.4206, 87.521, 44.4598, 4.4291, -5.56636, -3.60696, -44.7167, 34.3222, 61.3475, 23.3399, -8.67638, -33.0342, -37.1969, -43.3251, -41.6427, -19.7579, -14.9998, -33.3808, -46.1837, -82.7118, 79.0523, -2.29408, 58.4932, 75.0475, -3.72292, -45.5331, -50.1911, -56.8751, -77.6812, -23.4782, -8.33198, 57.6291, 57.5891, 47.6489, 28.7053, 22.8479, 13.9545, -16.0243, -41.2482, 37.6152, 58.5464, 15.6481, 10.7174, -6.50628, -28.6853, -20.8379, -22.0528, -8.19352, -1.52008, -33.0476, -60.8983, -68.6528, 80.7551, 22.53, 61.4504, 69.1299, 30.515, -34.1514, -22.9446, -33.8162, -58.4046, -17.0263, 6.30846, 101.339, 120.187, 27.2796, 20.3309, 2.61358, -8.2584, -14.2726, -34.5195, 8.2404, 36.272, 28.4486, -8.67732, -29.8159, -42.0228, -23.2677, -11.5861, -11.7867, -18.2456, -57.828, -64.6898, -66.6996, 88.4561, 47.3488, 66.4683, 77.3417, 61.9493, -19.6269, 16.5616, 3.75872, -26.6391, -71.3456, 24.8909, 46.9806, 32.8779, 8.91966, -19.8029, -17.4071, -15.2737, -20.2287, -49.3644, -3.51744, 1.36406, 18.4214, 10.2386, -10.9745, -36.1986, -31.5975, -14.9557, -27.2812, -54.8857, -65.6292, -56.7305, -67.9912, 100.153, 68.2693, 73.641, 84.7353, 77.4388, -3.06962, -5.88984, 37.3512, 3.92856, -45.7149, -1.50056, -11.3546, -17.3176, -17.322, -32.9007, -7.51902, -17.1807, -10.0192, -3.1516, -41.4033, -73.6966, -0.871437, 8.9167, -45.3246, -55.5067, -53.8701, -42.2754, -29.7307, -44.5335, -41.4956, -46.8072, -59.2294, 90.7273, 81.0742, 79.7892, 85.0861, 80.9101, 26.4741, -10.3144, 36.8062, 35.2299, 5.63684, -25.083, -49.9703, 3.27842, -8.57568, -4.17606, 29.1066, -10.5152, -10.3063, 16.5704, -10.7152, -11.965, -18.3184, -46.5426, -52.8363, -66.0118, -45.2859, -65.6626, -47.2182, -45.163, -54.422, -65.0628, -66.6677, 66.2721, 76.7943, 72.7404, 78.2243, 78.3058, 47.0292, -5.76302, 27.3722, 25.5977, 31.0646, 22.3091, -52.6602, 4.6311, -17.0328, 20.3517, 65.5303, 15.781, -29.0929, 0.722618, 2.51578, 15.3566, -24.9902, -59.2505, -53.4887, -51.7007, -11.0535, -44.4137, -37.0796, -42.1895, -55.6181, -59.5225, -66.242, 32.6225, 77.4249, 67.4544, 66.0964, 75.2879, 56.1866, 7.47782, 42.6144, 81.7754, 8.2015, -15.4058, -29.2789, -16.174, 14.0656, 71.451, 75.7368, 46.8312, -0.246758, -35.2913, -38.6098, -44.9065, -48.0581, -51.1504, -61.3652, -33.7075, -20.2597, -28.5749, -22.2593, -29.4033, -45.9874, -40.1648, -48.946, 10.8022, 90.8556, 68.9422, 62.5931, 74.8956, 43.8826, -11.6784, 56.4901, 147.726, 123.058, 42.2474, 45.5873, 62.7708, 90.8888, 107.238, 96.5206, 80.5176, 42.4386, 8.45688, -38.925, -43.3716, -33.3438, -14.419, 0.30146, 7.96772, 8.40464, 19.0795, 15.5356, 15.2842, 5.4058, 2.9839, 3.00684, 19.9398, 104.062, 85.2449, 71.9117, 78.239, 47.3092, 10.9243, 107.245, 145.541, 150.755, 130.822, 56.1411, 48.3833, 61.5059, 55.7339, 51.9589, 48.0049, 18.9528, 3.84642, 0.458, 10.0591, 9.02674, 13.9024, 23.75, 29.4631, 27.9839, 32.5514, 38.0315, 37.5724, 25.5164, 28.1214, 20.1446, 21.9369, 58.91, 81.1014, 82.8947, 88.2622, 71.3797, 62.1265, 135.582, 139.889, 127.05, 52.1283, 10.3277, 4.45608, 4.60732, 6.82018, 0.949661, 14.9821, 19.9278, 12.8066, 15.5538, 24.3211, 24.2016, 25.1161, 26.9338, 30.6815, 37.278, 34.7969, 34.1332, 30.6395, 27.5346, 30.1215, 21.2292, 27.7925, 20.5915, 26.8735, 70.6766, 87.1397, 34.2555, 79.0769, 140.561, 143.857, 73.9429, 26.0011, 17.2343, 18.3811, 20.5436, 19.7754, 15.8638, 16.8826, 16.8911, 14.8079, 12.5893, 19.5024, 24.3337, 24.1186, 28.739, 32.463, 43.0847, 39.6219, 38.7464, 41.3087, 37.2587, 30.9462, 37.168, 48.6391, 30.2625, 16.4082, 30.3018, 62.8592, 39.9818, 106.735, 147.195, 103.464, 16.6217, 26.7572, 23.9684, 26.1699, 26.4096, 20.7732, 14.7659, 12.7576, 11.8005, 12.6767, 16.265, 22.1943, 30.0144, 32.598, 36.1861, 47.8642, 49.4634, 44.0125, 45.0039, 48.5442, 44.6091, 57.5105, 70.019, 51.5305, 36.8828, 21.7783, 15.5473, 21.105, 60.2322, 130.936, 144.417, 50.6717, 11.8755, 21.1131, 29.4592, 27.7209, 17.9766, 18.2021, 18.184, 18.1024, 18.0222, 21.9331, 25.5758, 29.3838, 39.1189, 47.6983, 51.3123, 47.0583, 37.6027, 36.0823, 33.0557, 51.5705, 69.8143, 71.9455, 56.7232, 48.4333, 38.4805, 29.1863, 25.7107, 20.028, 33.041, 128.726, 130.078, 36.3645, 22.6837, 25.971, 21.4565, 30.9717, 21.2287, 14.2637, 17.3168, 20.1757, 24.0288, 27.8939, 29.6042, 37.2918, 34.8857, 35.3284, 44.04, 42.7858, 34.3193, 27.6887, 46.8013, 74.4701, 67.05, 31.4104, 26.444, 47.1436, 35.9395, 33.307, 32.5799, 30.6671, 18.4403, 53.0053, 105.329, 13.6902, 15.9714, 23.3084, 25.8569, 35.3708, 31.6255, 27.7454, 16.7359, 14.5495, 16.4072, 26.1954, 30.7661, 31.3745, 33.9685, 32.5813, 30.2155, 28.8884, 31.5652, 44.0091, 70.2621, 55.3065, 30.1816, -8.15202, 23.1119, 62.8579, 36.2211, 26.2646, 36.2178, 29.9819, 23.5712, 5.05328, 25.2625, 6.51664, -2.2874, -1.92552, 10.5829, 21.9576, 29.1253, 31.2158, 22.162, 25.1556, 31.0642, 32.8369, 31.4715, 30.0136, 28.6455, 23.3716, 17.016, 24.7127, 45.5134, 70.1319, 71.5727, 57.9698, 35.1291, -3.75116, 13.8945, 53.351, 35.3066, 19.8319, 31.4347, 27.9476, 23.3144, 14.6525, 1.73556, 4.85986, -5.98992, -7.72202, -0.390419, -3.1703, -1.08674, 5.88164, 10.8255, 18.9782, 25.8613, 34.7352, 46.4163, 42.0558, 23.7569, 16.4562, 16.2164, 32.9954, 58.915, 85.7914, 78.4728, 52.1219, 17.7436, 13.2816, -6.60626, 44.5544, 35.0288, 18.0594, 20.3446, 20.4793, 18.5399, 9.65686, 1.7444, 0.826561, -8.09936, -12.0079, -4.88196, -8.75814, -4.71286, -14.8297, -23.8564, -12.7057, 5.1816, 24.0701, 38.8784, 31.6238, 17.428, 16.2918, 9.28374, 31.2647, 53.2215, 68.1868, 61.1359, 31.1222, 10.1694, 15.0938, -4.38186};
			int[] pixels = new int[floatPixels.length] ;
			for (int j = 0; j < pixels.length/3; j++) {
				pixels[j * 3] = (int) (floatPixels[j]);
				pixels[j * 3 + 1] = (int) (floatPixels[pixels.length/3 + j]);
				pixels[j * 3 + 2] = (int) (floatPixels[2 * pixels.length/3 + j]);
			}
			
			BufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_3BYTE_BGR);
//          try {
//				image = ImageIO.read(new File("/home/jxchang/project/datasets/LFW/lfw-deepfunneled/AJ_Cook/AJ_Cook_0001.jpg"));
//			} catch (IOException e) {
//				// TODO Auto-generated catch block
//				e.printStackTrace();
//			}
			Image images = image.getScaledInstance(128, 128, Image.SCALE_SMOOTH);
            WritableRaster raster =  image.getRaster();
            raster.setPixels(0,0,width,height,pixels);

            imageLabel.setIcon(new ImageIcon(images));
            
            float[] label = cp.getNextBatchLabel();
			for (int j = 0; j < 10; j++) {
				if (label[j] == 1){
					type.setText(""+labels[j]);
					break;
				}
			}  

			System.out.printf("%d %s \n%s \n", pixels.length,Arrays.toString(floatPixels),Arrays.toString(label));           
    		try {
				Thread.sleep(1000);
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}
	}
	
	
	@Test
	public void CNNdemo() {
		boolean useOpenCL = true;
		boolean addBias = true;
		boolean padding = true;
		Logger logger = Logger.getLogger("CIFAR-10 demo with CNN");
		
		JFrame frame = new JFrame();
		frame.setMinimumSize(new Dimension(384, 384));
		frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		frame.getContentPane().setLayout(null);
        JLabel imageLabel = new JLabel();
        JLabel type = new JLabel("");
        JLabel pred = new JLabel("");
        JLabel correctCnt = new JLabel("");
        JLabel wrongCnt = new JLabel("");
        JButton plusBtn = new JButton("+");
        JButton minusBtn = new JButton("-");
        plusBtn.addActionListener(new ActionListener() {
			@Override
			public void actionPerformed(ActionEvent e) {
				// TODO Auto-generated method stub
				interval /=2;
			}});
        minusBtn.addActionListener(new ActionListener() {
			@Override
			public void actionPerformed(ActionEvent e) {
				// TODO Auto-generated method stub
				interval *=2;
			}});        

		frame.getContentPane().add(imageLabel);
		frame.getContentPane().add(type);
		frame.getContentPane().add(pred);
		frame.getContentPane().add(correctCnt);
		frame.getContentPane().add(wrongCnt);
		frame.getContentPane().add(plusBtn);
		frame.getContentPane().add(minusBtn);

		imageLabel.setBounds(128, 80, 128, 128);
		type.setBounds(128, 208, 240, 16);
		pred.setBounds(128, 230, 240, 16);
		correctCnt.setBounds(128, 280, 120, 16);
		wrongCnt.setBounds(128, 302, 120, 16);
		plusBtn.setBounds(280, 280, 60, 16);
		minusBtn.setBounds(280, 302, 60, 16);

		int[][] cnnLayers = new int[][] {	{3, 0, 0 ,0}, 
				{32, 5, 5, 1},
				{3, 3, 2}, 
				{32, 5, 5, 1},
				{3, 3, 2}, 
				{64, 5, 5, 1}, 
				{3, 3, 2}, 
				{64},
				{10}
				};
		ConvolutionalNeuralNetwork cnn = new ConvolutionalNeuralNetwork(cnnLayers, addBias, padding, useOpenCL); 
		cnn.setInputShape(new int[] {32, 32});
		Layer l1 = cnn.getInputLayer();
		ConvolutionalLayer l2 = (ConvolutionalLayer) l1.getNextLayer();
		PoolingLayer l3 = (PoolingLayer) l2.getNextLayer();
		ConvolutionalLayer l4 = (ConvolutionalLayer) l3.getNextLayer();
		PoolingLayer l5 = (PoolingLayer) l4.getNextLayer();
		ConvolutionalLayer l6 = (ConvolutionalLayer) l5.getNextLayer();
		PoolingLayer l7 = (PoolingLayer) l6.getNextLayer();
		FullyConnectedLayer l8 = (FullyConnectedLayer) l7.getNextLayer();
		FullyConnectedLayer l9 = (FullyConnectedLayer) l8.getNextLayer();
		l2.setActivationType(ActivationType.RELU);
		l4.setActivationType(ActivationType.RELU);
		l6.setActivationType(ActivationType.RELU);
		l8.setActivationType(ActivationType.NONE);
		l9.setActivationType(ActivationType.NONE);
		l3.setPoolingType(PoolingType.MAX);
		l5.setPoolingType(PoolingType.AVER);
		l7.setPoolingType(PoolingType.AVER);
		String weightsPath = "/home/jxchang/project/records/cifar/cnnReLU10.weights";
		cnn.loadWeights(weightsPath);
		
		CIFAR10DataProvider cp1 = new CIFAR10DataProvider("/home/jxchang/project/datasets/CIFAR/cifar-10-batches-bin", 10000, DatasetType.TEST, false);
		cnn.test(cp1);
		
		
		CIFAR10DataProvider cp = new CIFAR10DataProvider("/home/jxchang/project/datasets/CIFAR/cifar-10-batches-bin", 1, DatasetType.TEST, false, false, false);
//		CIFAR10DataProvider cp2 = new CIFAR10DataProvider("/home/jxchang/project/datasets/CIFAR/cifar-10-batches-bin", 1, DatasetType.TRAINING_ALL, false);
		int width = 32;
		int height = 32;
		String[] labels= {"airplane", 
				"automobile",
				"bird",
				"cat",
				"deer",
				"dog",
				"frog",
				"horse",
				"ship", 
				"truck"};
		
		
		imageLabel.setVisible(true);
		type.setVisible(true);
		pred.setVisible(true);
		frame.getContentPane().setVisible(true);
		frame.setVisible(true);
		plusBtn.setVisible(true);
		minusBtn.setVisible(true);

		float[] predictions = cnn.getOutputLayer().getActivations();
		int cnt1 = 0, cnt2 = 0;
		for (int i = 0; i < cp.getDatasetSize(); i ++) {
			float[] floatPixels = cp.getNextbatchInput();
			int[] pixels = new int[floatPixels.length] ;
			for (int j = 0; j < pixels.length/3; j++) {
				pixels[j * 3] = (int) (floatPixels[j]);
				pixels[j * 3 + 1] = (int) (floatPixels[pixels.length/3 + j]);
				pixels[j * 3 + 2] = (int) (floatPixels[2 * pixels.length/3 + j]);
			}
			
			BufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_3BYTE_BGR);

			Image images = image.getScaledInstance(128, 128, Image.SCALE_SMOOTH);
            WritableRaster raster =  image.getRaster();
            raster.setPixels(0,0,width,height,pixels);

            imageLabel.setIcon(new ImageIcon(images));
            
            float[] label = cp.getNextBatchLabel();
            int lableInd = 0;
			for (int j = 0; j < 10; j++) {
				if (label[j] == 1){
					type.setText("label:          "+labels[j]);
					lableInd = j;
					break;
				}
			}  
			int maxInd = 0;
			for (int j = 0; j < 9; j++) {
				if (predictions[i * 10 + maxInd] < predictions[i * 10 + j + 1]) {
					maxInd = j + 1;
				}
			}  
			pred.setText("prediction: "+labels[maxInd]);
			if (lableInd == maxInd) {
				cnt1++;
			} else {
				cnt2++;
			}
			correctCnt.setText("correct: " + cnt1);
			wrongCnt.setText("error: " + cnt2);

    		try {
				Thread.sleep(interval);
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}
		while(true);
	}
	
	@Test
	public void trainCNNReLUCaffe() {
		boolean useOpenCL = true;
		boolean addBias = true;
		boolean padding = true;
		int batchSize = 100;
		String p = Paths.get(System.getProperty("user.dir"), "..", "..", "..","datasets", "CIFAR", "cifar-10-batches-bin").toString();

		CIFAR10DataProvider trainingSet = new CIFAR10DataProvider(p, batchSize, DatasetType.TRAINING_ALL, false);
		CIFAR10DataProvider TestSet = new CIFAR10DataProvider(p, batchSize, DatasetType.TEST, false);
		int costType = 0; 
		float baselearningRate = 0.001f;
		float momentum = 0.9f;
		float weightDecay = 0.004f;//0.01f;
		int lrChangeCycle = 8 * trainingSet.getDatasetSize()/trainingSet.getBatchSize();
		float lrChangeRate = 0.1f;
		int epoch = 10;
		int[][] cnnLayers = new int[][] {	{3, 0, 0 ,0}, 
											{32, 5, 5, 1},
											{3, 3, 2}, 
											{32, 5, 5, 1},
											{3, 3, 2}, 
											{64, 5, 5, 1}, 
											{3, 3, 2}, 
											{64},
											{10}
											};
		ConvolutionalNeuralNetwork cnn = new ConvolutionalNeuralNetwork(cnnLayers, addBias, padding, useOpenCL); 
		Layer l1 = cnn.getInputLayer();
		ConvolutionalLayer l2 = (ConvolutionalLayer) l1.getNextLayer();
		PoolingLayer l3 = (PoolingLayer) l2.getNextLayer();
		ConvolutionalLayer l4 = (ConvolutionalLayer) l3.getNextLayer();
		PoolingLayer l5 = (PoolingLayer) l4.getNextLayer();
		ConvolutionalLayer l6 = (ConvolutionalLayer) l5.getNextLayer();
		PoolingLayer l7 = (PoolingLayer) l6.getNextLayer();
		FullyConnectedLayer l8 = (FullyConnectedLayer) l7.getNextLayer();
		FullyConnectedLayer l9 = (FullyConnectedLayer) l8.getNextLayer();
		l2.setActivationType(ActivationType.NONE);
		l3.setActivationType(ActivationType.RELU);
//		l3.setPadding(false);
		l4.setActivationType(ActivationType.RELU);
		l5.setActivationType(ActivationType.NONE);
//		l5.setPadding(false);
		l6.setActivationType(ActivationType.RELU);
		l7.setActivationType(ActivationType.NONE);
//		l7.setPadding(false);
		l8.setActivationType(ActivationType.NONE);
		l9.setActivationType(ActivationType.NONE);
		l3.setPoolingType(PoolingType.MAX);
		l5.setPoolingType(PoolingType.AVER);
		l7.setPoolingType(PoolingType.AVER);
//		l2.setPadding(false);
		cnn.setInputShape(new int[] {32, 32});
		
		l2.initWeightsGaussian(0.0001f, 0, 0);
		l4.initWeightsGaussian(0.01f, 0, 0);
		l6.initWeightsGaussian(0.01f, 0, 0);
		l8.initWeightsGaussian(0.1f, 0, 0);
		l9.initWeightsGaussian(0.1f, 0, 0);		

//		l2.setLearningRateMultiplication(2f);
//		l4.setLearningRateMultiplication(2.5f);
//		l6.setLearningRateMultiplication(2f);
//		l8.setLearningRateMultiplication(1.5f);
//		l9.setLearningRateMultiplication(5f);
		
		Logger logger = Logger.getLogger("CIFAR10 traing with CNN");
		logger.log(Level.INFO, "CNN architecture: \n"
				+ "{0} {1} bias \n"
				+ "conv layer activation type: {2}\n"
				+ "fully layer activation type: {3}"
				, new Object[] {Arrays.deepToString(cnnLayers), addBias ? "with" : "without", ActivationType.RELU, ActivationType.RELU});

		logger.log(Level.INFO, "Traning configuration: \n"
				+ "useOpenCL = {0} \n"
				+ "batchSize = {1} \n"
				+ "costType = {2} \n"
				+ "epoch = {3} \n"
				+ "baselearningRate = {4} \n"
				+ "momentum = {5} \n"
				+ "weightDecay = {6} \n"
				+ "lrChangeCycle = {7} \n"
				+ "lrChangeRate = {8} \n", new Object[] {useOpenCL, batchSize, (costType==0?"CE":"MSE"), epoch, baselearningRate+"", momentum, weightDecay, lrChangeCycle, lrChangeRate});
		String path = "/home/jxchang/project/records/cifar/.cnnReLU.weights";

		
		logger.log(Level.INFO, "Pretest before training...");
//		cnn.test(TestSet);
//		cnn.loadWeights(path);
		//load the weights identical to caffe
//		cnn.loadWeights("/Users/jxchang/project/records/cifar/compare/caffe.weights");
		cnn.test(TestSet);
		cnn.train(trainingSet, costType, baselearningRate, momentum, weightDecay, lrChangeCycle, lrChangeRate, epoch, TestSet, 500);
//		cnn.train(trainingSet, costType, baselearningRate/10, momentum, weightDecay, lrChangeCycle, lrChangeRate, 2, TestSet, 500);


//		cnn.test(trainingSet);
		
//		logger.log(Level.INFO, "Saving weights...");
//		cnn.saveWeights(path);

//		float errorRate = cnn.test(TestSet);
//		assertEquals(0, errorRate, 0.1);	

	}
	
	
	@Test
	public void trainCNN() {
		boolean useOpenCL = true;
		boolean addBias = true;
		boolean padding = true;
		int batchSize = 100;
		String p = Paths.get(System.getProperty("user.dir"), "..", "..", "..","datasets", "CIFAR", "cifar-10-batches-bin").toString();

		CIFAR10DataProvider trainingSet = new CIFAR10DataProvider(p, batchSize, DatasetType.TRAINING_ALL, false, true, true);
		CIFAR10DataProvider testSet = new CIFAR10DataProvider(p, 2000, DatasetType.TEST, false, true, true);
		int costType = 0; 
		float baselearningRate = 0.05f;
		float momentum = 0.8f;
		float weightDecay = 0.1f;//0.004f;
		int lrChangeCycle = 0;//1 * trainingSet.getDatasetSize()/trainingSet.getBatchSize();
		float lrChangeRate = 0.15f;
		int epoch = 10;
		int[][] cnnLayers = new int[][] {	{3, 0, 0 ,0}, 
											{64, 5, 5, 1},
											{3, 3, 2}, 
											{64, 4, 4, 1},
											{3, 3, 2}, 
											{128, 3, 3, 1}, 
											{3, 3, 2}, 
											{64},
											{10}
											};
		ConvolutionalNeuralNetwork cnn = new ConvolutionalNeuralNetwork(cnnLayers, addBias, padding, useOpenCL); 
//		Layer l1 = cnn.getInputLayer();
//		ConvolutionalLayer l2 = (ConvolutionalLayer) l1.getNextLayer();
//		PoolingLayer l3 = (PoolingLayer) l2.getNextLayer();
//		ConvolutionalLayer l4 = (ConvolutionalLayer) l3.getNextLayer();
//		PoolingLayer l5 = (PoolingLayer) l4.getNextLayer();
//		ConvolutionalLayer l6 = (ConvolutionalLayer) l5.getNextLayer();
//		PoolingLayer l7 = (PoolingLayer) l6.getNextLayer();
//		FullyConnectedLayer l8 = (FullyConnectedLayer) l7.getNextLayer();
//		FullyConnectedLayer l9 = (FullyConnectedLayer) l8.getNextLayer();
//		l2.setActivationType(ActivationType.RELU);
//		l3.setActivationType(ActivationType.NONE);
//		l4.setActivationType(ActivationType.RELU);
//		l5.setActivationType(ActivationType.NONE);
//		l6.setActivationType(ActivationType.RELU);
//		l7.setActivationType(ActivationType.NONE);
//		l8.setActivationType(ActivationType.NONE);
//		l9.setActivationType(ActivationType.NONE);
//		l3.setPoolingType(PoolingType.MAX);
//		l5.setPoolingType(PoolingType.AVER);
//		l7.setPoolingType(PoolingType.AVER);
		cnn.setInputShape(new int[] {32, 32});
		
//		l2.initWeightsGaussian(0.0001f, 0, 0);
//		l4.initWeightsGaussian(0.01f, 0, 0);
//		l6.initWeightsGaussian(0.01f, 0, 0);
//		l8.initWeightsGaussian(0.1f, 0, 0);
//		l9.initWeightsGaussian(0.1f, 0, 0);		

//		l2.setLearningRateMultiplication(2f);
//		l4.setLearningRateMultiplication(2.5f);
//		l6.setLearningRateMultiplication(2f);
//		l8.setLearningRateMultiplication(1.5f);
//		l9.setLearningRateMultiplication(5f);
		
		Logger logger = Logger.getLogger("CIFAR10 traing with CNN");
		logger.log(Level.INFO, "CNN architecture: \n"
				+ "{0} {1} bias \n"
				+ "conv layer activation type: {2}\n"
				+ "fully layer activation type: {3}"
				, new Object[] {Arrays.deepToString(cnnLayers), addBias ? "with" : "without", ActivationType.RELU, ActivationType.NONE});

		logger.log(Level.INFO, "Traning configuration: \n"
				+ "useOpenCL = {0} \n"
				+ "batchSize = {1} \n"
				+ "costType = {2} \n"
				+ "epoch = {3} \n"
				+ "baselearningRate = {4} \n"
				+ "momentum = {5} \n"
				+ "weightDecay = {6} \n"
				+ "lrChangeCycle = {7} \n"
				+ "lrChangeRate = {8} \n", new Object[] {useOpenCL, batchSize, (costType==0?"CE":"MSE"), epoch, baselearningRate+"", momentum, weightDecay, lrChangeCycle, lrChangeRate});
//		String path = "/home/jxchang/project/records/cifar/.cnnReLU.weights";
		String loadPath = Paths.get(System.getProperty("user.dir"), "..", "..", "..","records", "cifar", "cnn254.weights").toString();

		
		logger.log(Level.INFO, "Pretest before training...");
//		cnn.test(TestSet);
//		cnn.loadWeights(loadPath);
		cnn.test(testSet);
		for (int i = 0; i < epoch; i += 3) {
			logger.log(Level.INFO, "learning rate {0}", baselearningRate);
			cnn.train(trainingSet, costType, baselearningRate, momentum, weightDecay, lrChangeCycle, lrChangeRate, 3, testSet, trainingSet.getDatasetSize()/trainingSet.getBatchSize());
			cnn.test(trainingSet);
			if (i < 10)
			baselearningRate *= lrChangeRate;
		}
		
//		logger.log(Level.INFO, "Saving weights...");
		String savePath = Paths.get(System.getProperty("user.dir"), "..", "..", "..","records", "cifar", "cnn.weights").toString();
//		cnn.saveWeights(savePath);

//		float errorRate = cnn.test(TestSet);
//		assertEquals(0, errorRate, 0.1);	

	}
	
	
	
	
//	@Test
//	public void TrainMLP() {
//		boolean useOpenCL = true;
//		boolean addBias = true;
//		int batchSize = 64;
//		CIFAR10DataProvider trainingSet = new CIFAR10DataProvider("/home/jxchang/project/datasets/CIFAR/cifar-10-batches-bin", batchSize, DatasetType.TRAINING_ALL, false);
//		CIFAR10DataProvider TestSet = new CIFAR10DataProvider("/home/jxchang/project/datasets/CIFAR/cifar-10-batches-bin", 10000, DatasetType.TEST, false);
//		int costType = 0; //cross entropy
//		float baselearningRate = 0.02f;
//		float momentum = 0.9f;
//		float weightDecay = 0.05f;
//		int lrChangeCycle = 0;//10 * trainingSet.getDatasetSize()/trainingSet.getBatchSize();
//		float lrChangeRate = 0.33f;
//		int epoch = 20;
//		int[] mlpLayers = new int[]{3072, 1024, 512 ,10};
//		NeuralNetwork mlp = new MultiLayerPerceptron(mlpLayers, addBias, useOpenCL); 
//		
//		Logger logger = Logger.getLogger("CIFAR10 traing with MLP");
//		logger.log(Level.INFO, "MLP architecture: \n"
//				+ "{0} {1} bias \n", new Object[] {Arrays.toString(mlpLayers), addBias ? "with" : "without"});
//
//		logger.log(Level.INFO, "Traning configuration: \n"
//				+ "useOpenCL = {0} \n"
//				+ "batchSize = {1} \n"
//				+ "costType = {2} \n"
//				+ "epoch = {3} \n"
//				+ "baselearningRate = {4} \n"
//				+ "momentum = {5} \n"
//				+ "weightDecay = {6} \n"
//				+ "lrChangeCycle = {7} \n"
//				+ "lrChangeRate = {8} \n", new Object[] {useOpenCL, batchSize, (costType==0?"CE":"MSE"), epoch, baselearningRate, momentum, weightDecay, lrChangeCycle, lrChangeRate});
//		
////		mlp.test(trainingSet);
//		mlp.test(TestSet);
//		
//		logger.log(Level.INFO, "Training start...");
//		mlp.train(trainingSet, costType, baselearningRate, momentum, weightDecay, lrChangeCycle, lrChangeRate, epoch);
//
//		logger.log(Level.INFO, "Saving weights...");
//		String path = "/home/jxchang/project/records/cifar/.mlp.weights";
//		mlp.saveWeights(path);
//		logger.log(Level.INFO, "Weights saved to " + path);
//
//		mlp.test(trainingSet);
////		System.out.println("Test with test set...");
//		float errorRate = mlp.test(TestSet);
//		assertEquals(0, errorRate, 0.1);		
//	}
	

//	@Test
//	public void TrainCNN() {
//		boolean useOpenCL = true;
//		boolean addBias = true;
//		boolean padding = true;
//		int batchSize = 100;
//		CIFAR10DataProvider trainingSet = new CIFAR10DataProvider("/home/jxchang/project/datasets/CIFAR/cifar-10-batches-bin", batchSize, DatasetType.TRAINING_ALL, false);
//		CIFAR10DataProvider TestSet = new CIFAR10DataProvider("/home/jxchang/project/datasets/CIFAR/cifar-10-batches-bin", batchSize, DatasetType.TEST, false);
//		int costType = 0; 
//		float baselearningRate = 0.005f;
//		float momentum = 0.9f;
//		float weightDecay = 0;//0.01f;
//		int lrChangeCycle = 5 * trainingSet.getDatasetSize()/trainingSet.getBatchSize();
//		float lrChangeRate = 0.33f;
//		int epoch = 1;
//		int[][] cnnLayers = new int[][] {	{3, 0, 0 ,0}, 
//											{32, 5, 5, 1},
//											{2, 2, 2}, 
//											{32, 5, 5, 1},
//											{2, 2, 2}, 
//											{64, 5, 5, 1}, 
//											{2, 2, 2}, 
//											{64},
//											{10}
//											};
//		ConvolutionalNeuralNetwork cnn = new ConvolutionalNeuralNetwork(cnnLayers, addBias, padding, useOpenCL); 
//		cnn.setInputShape(new int[] {32, 32});
//		Layer l1 = cnn.getInputLayer();
//		Layer l2 = l1.getNextLayer();
//		PoolingLayer l3 = (PoolingLayer) l2.getNextLayer();
//		Layer l4 = l3.getNextLayer();
//		PoolingLayer l5 = (PoolingLayer) l4.getNextLayer();
//		Layer l6 = l5.getNextLayer();
//		PoolingLayer l7 = (PoolingLayer) l6.getNextLayer();
//		Layer l8 = l7.getNextLayer();
//		Layer l9 = l8.getNextLayer();
//		l2.setActivationType(ActivationType.TANH);
//		l4.setActivationType(ActivationType.TANH);
//		l6.setActivationType(ActivationType.TANH);
//		l8.setActivationType(ActivationType.TANH);
//		l9.setActivationType(ActivationType.TANH);
//		l3.setPoolingType(PoolingType.MAX);
//		l5.setPoolingType(PoolingType.AVER);
//		l7.setPoolingType(PoolingType.AVER);
//		
//		Logger logger = Logger.getLogger("CIFAR10 traing with CNN");
//		logger.log(Level.INFO, "CNN architecture: \n"
//				+ "{0} {1} bias \n"
//				+ "conv layer activation type: {2}\n"
//				+ "fully layer activation type: {3}"
//				, new Object[] {Arrays.deepToString(cnnLayers), addBias ? "with" : "without", ActivationType.TANH, ActivationType.TANH});
//
//		logger.log(Level.INFO, "Traning configuration: \n"
//				+ "useOpenCL = {0} \n"
//				+ "batchSize = {1} \n"
//				+ "costType = {2} \n"
//				+ "epoch = {3} \n"
//				+ "baselearningRate = {4} \n"
//				+ "momentum = {5} \n"
//				+ "weightDecay = {6} \n"
//				+ "lrChangeCycle = {7} \n"
//				+ "lrChangeRate = {8} \n", new Object[] {useOpenCL, batchSize, (costType==0?"CE":"MSE"), epoch, baselearningRate, momentum, weightDecay, lrChangeCycle, lrChangeRate});
//
//		
////		System.out.println(Arrays.toString(l2.getWeight()));
//		logger.log(Level.INFO, "Pretest before training...");
//		cnn.test(TestSet);
//		
//		String path = "/home/jxchang/project/records/cifar/.cnn.weights";
////		cnn.loadWeights(path);
////
////		cnn.test(TestSet);
//		
//		
//		cnn.train(trainingSet, costType, baselearningRate, momentum, weightDecay, lrChangeCycle, lrChangeRate, epoch);
////		System.out.println(Arrays.toString(l2.getWeight()));
//
//
//		cnn.test(trainingSet);
////		System.out.println("Test with test set...");
//		
////		cnn.saveWeights(path);
//
//		float errorRate = cnn.test(TestSet);
//		assertEquals(0, errorRate, 0.1);	
//		
//		logger.log(Level.INFO, "Saving weights...");
//
//	}
}
